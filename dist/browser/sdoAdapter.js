(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.sdoAdapter = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){

},{}],2:[function(require,module,exports){
"use strict";const{clone:clone}=require("./util");module.exports=class{constructor(t=100){this.order=[],this.cache=new Map,this.size=t}get(t,e){const s=this.cache.get(t);if(s){const t=JSON.stringify(e);return s.get(t)||null}return null}set(t,e,s){if(this.order.length===this.size){const t=this.order.shift();this.cache.get(t.activeCtx).delete(t.localCtx)}const c=JSON.stringify(e);this.order.push({activeCtx:t,localCtx:c});let i=this.cache.get(t);i||(i=new Map,this.cache.set(t,i)),i.set(c,clone(s))}};

},{"./util":23}],3:[function(require,module,exports){
"use strict";module.exports=class extends Error{constructor(r="An unspecified JSON-LD error occurred.",s="jsonld.Error",e={}){super(r),this.name=s,this.message=r,this.details=e}};

},{}],4:[function(require,module,exports){
"use strict";module.exports=(e=>{class t{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(t,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(t.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:t}),t.compact=function(t,r){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):e.compact(t,r)},t.expand=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):e.expand(t)},t.flatten=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):e.flatten(t)},t});

},{}],5:[function(require,module,exports){
"use strict";module.exports=require("rdf-canonize").NQuads;

},{"rdf-canonize":40}],6:[function(require,module,exports){
"use strict";const{RDF_LANGSTRING:RDF_LANGSTRING,RDF_PLAIN_LITERAL:RDF_PLAIN_LITERAL,RDF_OBJECT:RDF_OBJECT,RDF_XML_LITERAL:RDF_XML_LITERAL,XSD_STRING:XSD_STRING}=require("./constants");let _Node;function getXMLSerializerClass(){return"undefined"==typeof XMLSerializer?require("xmldom").XMLSerializer:XMLSerializer}_Node="undefined"!=typeof Node?Node:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},module.exports=class{parse(e){const t={"@default":[]},N=e.getSubjects();for(let l=0;l<N.length;++l){const _=N[l];if(null===_)continue;const n=e.getSubjectTriples(_);if(null===n)continue;const E=n.predicates;for(const e in E){const N=E[e].objects;for(let l=0;l<N.length;++l){const n=N[l],E={};0===_.indexOf("_:")?E.subject={type:"blank node",value:_}:E.subject={type:"IRI",value:_},0===e.indexOf("_:")?E.predicate={type:"blank node",value:e}:E.predicate={type:"IRI",value:e};let a=n.value;if(n.type===RDF_XML_LITERAL){const e=new(getXMLSerializerClass());a="";for(let t=0;t<n.value.length;t++)n.value[t].nodeType===_Node.ELEMENT_NODE?a+=e.serializeToString(n.value[t]):n.value[t].nodeType===_Node.TEXT_NODE&&(a+=n.value[t].nodeValue)}E.object={},n.type===RDF_OBJECT?0===n.value.indexOf("_:")?E.object.type="blank node":E.object.type="IRI":(E.object.type="literal",n.type===RDF_PLAIN_LITERAL?n.language?(E.object.datatype=RDF_LANGSTRING,E.object.language=n.language):E.object.datatype=XSD_STRING:E.object.datatype=n.type),E.object.value=a,t["@default"].push(E)}}}return t}};

},{"./constants":9,"xmldom":1}],7:[function(require,module,exports){
"use strict";const{callbackify:callbackify,normalizeDocumentLoader:normalizeDocumentLoader}=require("./util");module.exports=class{constructor(){this._requests={},this.add=callbackify(this.add.bind(this))}wrapLoader(e){const r=this;return r._loader=normalizeDocumentLoader(e),function(){return r.add.apply(r,arguments)}}async add(e){const r=this;let t=r._requests[e];if(t)return Promise.resolve(t);t=r._requests[e]=r._loader(e);try{return await t}finally{delete r._requests[e]}}};

},{"./util":23}],8:[function(require,module,exports){
"use strict";const JsonLdError=require("./JsonLdError"),{isArray:_isArray,isObject:_isObject,isString:_isString,isUndefined:_isUndefined}=require("./types"),{isList:_isList,isValue:_isValue,isGraph:_isGraph,isSimpleGraph:_isSimpleGraph,isSubjectReference:_isSubjectReference}=require("./graphTypes"),{expandIri:_expandIri,getContextValue:_getContextValue,isKeyword:_isKeyword,process:_processContext}=require("./context"),{removeBase:_removeBase}=require("./url"),{addValue:_addValue,asArray:_asArray,compareShortestLeast:_compareShortestLeast}=require("./util"),api={};function _selectTerm(e,t,i,a,n,r){null===r&&(r="@null");const s=[];if("@id"!==r&&"@reverse"!==r||!_isSubjectReference(i))s.push(r);else{"@reverse"===r&&s.push("@reverse");const t=api.compactIri({activeCtx:e,iri:i["@id"],relativeTo:{vocab:!0}});e.mappings.has(t)&&e.mappings.get(t)&&e.mappings.get(t)["@id"]===i["@id"]?s.push.apply(s,["@vocab","@id"]):s.push.apply(s,["@id","@vocab"])}s.push("@none");const o=e.inverse[t];for(let e=0;e<a.length;++e){const t=a[e];if(!(t in o))continue;const i=o[t][n];for(let e=0;e<s.length;++e){const t=s[e];if(t in i)return i[t]}}return null}function _checkNestProperty(e,t,i){if("@nest"!==_expandIri(e,t,{vocab:!0},i))throw new JsonLdError("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}module.exports=api,api.compact=(({activeCtx:e,activeProperty:t=null,element:i,options:a={},compactionMap:n=(()=>void 0)})=>{if(_isArray(i)){let r=[];for(let s=0;s<i.length;++s){let o=api.compact({activeCtx:e,activeProperty:t,element:i[s],options:a,compactionMap:n});null===o&&void 0===(o=n({unmappedValue:i[s],activeCtx:e,activeProperty:t,parent:i,index:s,options:a}))||r.push(o)}if(a.compactArrays&&1===r.length){0===(_getContextValue(e,t,"@container")||[]).length&&(r=r[0])}return r}const r=_getContextValue(e,t,"@context");if(_isUndefined(r)||(e=_processContext({activeCtx:e,localCtx:r,isPropertyTermScopedContext:!0,options:a})),_isObject(i)){if(a.link&&"@id"in i&&a.link.hasOwnProperty(i["@id"])){const e=a.link[i["@id"]];for(let t=0;t<e.length;++t)if(e[t].expanded===i)return e[t].compacted}if(_isValue(i)||_isSubjectReference(i)){const n=api.compactValue({activeCtx:e,activeProperty:t,value:i,options:a});return a.link&&_isSubjectReference(i)&&(a.link.hasOwnProperty(i["@id"])||(a.link[i["@id"]]=[]),a.link[i["@id"]].push({expanded:i,compacted:n})),n}const r="@reverse"===t,s={};e=e.revertTypeScopedContext(),a.link&&"@id"in i&&(a.link.hasOwnProperty(i["@id"])||(a.link[i["@id"]]=[]),a.link[i["@id"]].push({expanded:i,compacted:s}));let o=i["@type"]||[];o.length>1&&(o=Array.from(o).sort());const c=e;for(const t of o){const i=api.compactIri({activeCtx:c,iri:t,relativeTo:{vocab:!0}}),n=_getContextValue(c,i,"@context");_isUndefined(n)||(e=_processContext({activeCtx:e,localCtx:n,options:a,isTypeScopedContext:!0}))}const p=Object.keys(i).sort();for(const o of p){const c=i[o];if("@id"!==o&&"@type"!==o)if("@reverse"!==o)if("@preserve"!==o)if("@index"!==o)if("@graph"!==o&&"@list"!==o&&_isKeyword(o)){const t=api.compactIri({activeCtx:e,iri:o,relativeTo:{vocab:!0}});_addValue(s,t,c)}else{if(!_isArray(c))throw new JsonLdError("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===c.length){const t=api.compactIri({activeCtx:e,iri:o,value:c,relativeTo:{vocab:!0},reverse:r}),i=e.mappings.has(t)?e.mappings.get(t)["@nest"]:null;let n=s;i&&(_checkNestProperty(e,i,a),_isObject(s[i])||(s[i]={}),n=s[i]),_addValue(n,t,c,{propertyIsArray:!0})}for(const t of c){const i=api.compactIri({activeCtx:e,iri:o,value:t,relativeTo:{vocab:!0},reverse:r}),c=e.mappings.has(i)?e.mappings.get(i)["@nest"]:null;let p=s;c&&(_checkNestProperty(e,c,a),_isObject(s[c])||(s[c]={}),p=s[c]);const l=_getContextValue(e,i,"@container")||[],u=_isGraph(t),d=_isList(t);let v;d?v=t["@list"]:u&&(v=t["@graph"]);let g=api.compact({activeCtx:e,activeProperty:i,element:d||u?v:t,options:a,compactionMap:n});if(d)if(_isArray(g)||(g=[g]),l.includes("@list")){if(p.hasOwnProperty(i))throw new JsonLdError('JSON-LD compact error; property has a "@list" @container rule but there is more than a single @list that matches the compacted term in the document. Compaction might mix unwanted items into the list.',"jsonld.SyntaxError",{code:"compaction to list of lists"})}else g={[api.compactIri({activeCtx:e,iri:"@list",relativeTo:{vocab:!0}})]:g},"@index"in t&&(g[api.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=t["@index"]);if(u)if(l.includes("@graph")&&(l.includes("@id")||l.includes("@index")&&_isSimpleGraph(t))){let n;p.hasOwnProperty(i)?n=p[i]:p[i]=n={};const r=(l.includes("@id")?t["@id"]:t["@index"])||api.compactIri({activeCtx:e,iri:"@none",vocab:!0});_addValue(n,r,g,{propertyIsArray:!a.compactArrays||l.includes("@set")})}else l.includes("@graph")&&_isSimpleGraph(t)?_addValue(p,i,g,{propertyIsArray:!a.compactArrays||l.includes("@set")}):(_isArray(g)&&1===g.length&&a.compactArrays&&(g=g[0]),g={[api.compactIri({activeCtx:e,iri:"@graph",relativeTo:{vocab:!0}})]:g},"@id"in t&&(g[api.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]=t["@id"]),"@index"in t&&(g[api.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=t["@index"]),_addValue(p,i,g,{propertyIsArray:!a.compactArrays||l.includes("@set")}));else if(l.includes("@language")||l.includes("@index")||l.includes("@id")||l.includes("@type")){let a,n;if(p.hasOwnProperty(i)?a=p[i]:p[i]=a={},l.includes("@language"))_isValue(g)&&(g=g["@value"]),n=t["@language"];else if(l.includes("@index"))n=t["@index"];else if(l.includes("@id")){const t=api.compactIri({activeCtx:e,iri:"@id",vocab:!0});n=g[t],delete g[t]}else if(l.includes("@type")){const t=api.compactIri({activeCtx:e,iri:"@type",vocab:!0});let i;switch([n,...i]=_asArray(g[t]||[]),i.length){case 0:delete g[t];break;case 1:g[t]=i[0];break;default:g[t]=i}}n||(n=api.compactIri({activeCtx:e,iri:"@none",vocab:!0})),_addValue(a,n,g,{propertyIsArray:l.includes("@set")})}else{const e=!a.compactArrays||l.includes("@set")||l.includes("@list")||_isArray(g)&&0===g.length||"@list"===o||"@graph"===o;_addValue(p,i,g,{propertyIsArray:e})}}}else{if((_getContextValue(e,t,"@container")||[]).includes("@index"))continue;const i=api.compactIri({activeCtx:e,iri:o,relativeTo:{vocab:!0}});_addValue(s,i,c)}else{const i=api.compact({activeCtx:e,activeProperty:t,element:c,options:a,compactionMap:n});_isArray(i)&&0===i.length||_addValue(s,o,i)}else{const t=api.compact({activeCtx:e,activeProperty:"@reverse",element:c,options:a,compactionMap:n});for(const i in t)if(e.mappings.has(i)&&e.mappings.get(i).reverse){const n=t[i],r=(_getContextValue(e,i,"@container")||[]).includes("@set")||!a.compactArrays;_addValue(s,i,n,{propertyIsArray:r}),delete t[i]}if(Object.keys(t).length>0){const i=api.compactIri({activeCtx:e,iri:o,relativeTo:{vocab:!0}});_addValue(s,i,t)}}else{const t="@type"===o,i=t&&e.previousContext||e;let a=_asArray(c).map(e=>api.compactIri({activeCtx:i,iri:e,relativeTo:{vocab:t}}));1===a.length&&(a=a[0]);const n=api.compactIri({activeCtx:e,iri:o,relativeTo:{vocab:!0}}),r=_isArray(a)&&0===c.length;_addValue(s,n,a,{propertyIsArray:r})}}return s}return i}),api.compactIri=(({activeCtx:e,iri:t,value:i=null,relativeTo:a={vocab:!1},reverse:n=!1})=>{if(null===t)return t;e.isPropertyTermScoped&&e.previousContext&&(e=e.previousContext);const r=e.getInverse();if(_isKeyword(t)&&t in r&&"@none"in r[t]&&"@type"in r[t]["@none"]&&"@none"in r[t]["@none"]["@type"])return r[t]["@none"]["@type"]["@none"];if(a.vocab&&t in r){const a=e["@language"]||"@none",r=[];_isObject(i)&&"@index"in i&&!("@graph"in i)&&r.push("@index","@index@set"),_isObject(i)&&"@preserve"in i&&(i=i["@preserve"][0]),_isGraph(i)?("@index"in i&&r.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in i&&r.push("@graph@id","@graph@id@set"),r.push("@graph","@graph@set","@set"),"@index"in i||r.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in i||r.push("@graph@id","@graph@id@set")):_isObject(i)&&!_isValue(i)&&r.push("@id","@id@set","@type","@set@type");let s="@language",o="@null";if(n)s="@type",o="@reverse",r.push("@set");else if(_isList(i)){"@index"in i||r.push("@list");const e=i["@list"];if(0===e.length)s="@any",o="@none";else{let t=0===e.length?a:null,i=null;for(let a=0;a<e.length;++a){const n=e[a];let r="@none",s="@none";if(_isValue(n)?"@language"in n?r=n["@language"]:"@type"in n?s=n["@type"]:r="@null":s="@id",null===t?t=r:r!==t&&_isValue(n)&&(t="@none"),null===i?i=s:s!==i&&(i="@none"),"@none"===t&&"@none"===i)break}t=t||"@none","@none"!==(i=i||"@none")?(s="@type",o=i):o=t}}else _isValue(i)?"@language"in i&&!("@index"in i)?(r.push("@language","@language@set"),o=i["@language"]):"@type"in i&&(s="@type",o=i["@type"]):(s="@type",o="@id"),r.push("@set");r.push("@none"),!_isObject(i)||"@index"in i||r.push("@index","@index@set"),_isValue(i)&&1===Object.keys(i).length&&r.push("@language","@language@set");const c=_selectTerm(e,t,i,r,s,o);if(null!==c)return c}if(a.vocab&&"@vocab"in e){const i=e["@vocab"];if(0===t.indexOf(i)&&t!==i){const a=t.substr(i.length);if(!e.mappings.has(a))return a}}let s=null;const o=[];let c=e.fastCurieMap;const p=t.length-1;for(let e=0;e<p&&t[e]in c;++e)""in(c=c[t[e]])&&o.push(c[""][0]);for(let a=o.length-1;a>=0;--a){const n=o[a],r=n.terms;for(const a of r){const r=a+":"+t.substr(n.iri.length);e.mappings.get(a)._prefix&&(!e.mappings.has(r)||null===i&&e.mappings.get(r)["@id"]===t)&&(null===s||_compareShortestLeast(r,s)<0)&&(s=r)}}return null!==s?s:a.vocab?t:_removeBase(e["@base"],t)}),api.compactValue=(({activeCtx:e,activeProperty:t,value:i,options:a})=>{if(_isValue(i)){const a=_getContextValue(e,t,"@type"),n=_getContextValue(e,t,"@language"),r=_getContextValue(e,t,"@container")||[],s="@index"in i&&!r.includes("@index");if(!s&&(i["@type"]===a||i["@language"]===n))return i["@value"];const o=Object.keys(i).length,c=1===o||2===o&&"@index"in i&&!s,p="@language"in e,l=_isString(i["@value"]),u=e.mappings.has(t)&&null===e.mappings.get(t)["@language"];if(c&&(!p||!l||u))return i["@value"];const d={};return s&&(d[api.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=i["@index"]),"@type"in i?d[api.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}})]=api.compactIri({activeCtx:e,iri:i["@type"],relativeTo:{vocab:!0}}):"@language"in i&&(d[api.compactIri({activeCtx:e,iri:"@language",relativeTo:{vocab:!0}})]=i["@language"]),d[api.compactIri({activeCtx:e,iri:"@value",relativeTo:{vocab:!0}})]=i["@value"],d}const n=_expandIri(e,t,{vocab:!0},a),r=_getContextValue(e,t,"@type"),s=api.compactIri({activeCtx:e,iri:i["@id"],relativeTo:{vocab:"@vocab"===r}});return"@id"===r||"@vocab"===r||"@graph"===n?s:{[api.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]:s}}),api.removePreserve=((e,t,i)=>{if(_isArray(t)){const a=[];for(let n=0;n<t.length;++n){const r=api.removePreserve(e,t[n],i);null!==r&&a.push(r)}t=a}else if(_isObject(t)){if("@preserve"in t)return"@null"===t["@preserve"]?null:t["@preserve"];if(_isValue(t))return t;if(_isList(t))return t["@list"]=api.removePreserve(e,t["@list"],i),t;const a=api.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}});if(t.hasOwnProperty(a)){const e=t[a];if(i.link.hasOwnProperty(e)){const a=i.link[e].indexOf(t);if(-1!==a)return i.link[e][a];i.link[e].push(t)}else i.link[e]=[t]}const n=api.compactIri({activeCtx:e,iri:"@graph",relativeTo:{vocab:!0}});for(const r in t){if(r===a&&i.bnodesToClear.includes(t[r])){delete t[a];continue}let s=api.removePreserve(e,t[r],i);const o=_getContextValue(e,r,"@container")||[];i.compactArrays&&_isArray(s)&&1===s.length&&0===o.length&&r!==n&&(s=s[0]),t[r]=s}}return t});

},{"./JsonLdError":3,"./context":10,"./graphTypes":17,"./types":21,"./url":22,"./util":23}],9:[function(require,module,exports){
"use strict";const RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",XSD="http://www.w3.org/2001/XMLSchema#";module.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",RDF:RDF,RDF_LIST:RDF+"List",RDF_FIRST:RDF+"first",RDF_REST:RDF+"rest",RDF_NIL:RDF+"nil",RDF_TYPE:RDF+"type",RDF_PLAIN_LITERAL:RDF+"PlainLiteral",RDF_XML_LITERAL:RDF+"XMLLiteral",RDF_OBJECT:RDF+"object",RDF_LANGSTRING:RDF+"langString",XSD:XSD,XSD_BOOLEAN:XSD+"boolean",XSD_DOUBLE:XSD+"double",XSD_INTEGER:XSD+"integer",XSD_STRING:XSD+"string"};

},{}],10:[function(require,module,exports){
"use strict";const util=require("./util"),ActiveContextCache=require("./ActiveContextCache"),JsonLdError=require("./JsonLdError"),{isArray:_isArray,isObject:_isObject,isString:_isString,isUndefined:_isUndefined}=require("./types"),{isAbsolute:_isAbsoluteIri,isRelative:_isRelativeIri,prependBase:prependBase,parse:parseUrl}=require("./url"),{asArray:_asArray,compareShortestLeast:_compareShortestLeast}=require("./util"),MAX_CONTEXT_URLS=10,INITIAL_CONTEXT_CACHE=new Map,INITIAL_CONTEXT_CACHE_MAX_SIZE=1e4,api={};function _expandIri(e,n,t,o,r,i){if(null===n||!_isString(n)||api.isKeyword(n))return n;if(o&&o.hasOwnProperty(n)&&!0!==r.get(n)&&api.createTermDefinition(e,o,n,r,i),e.isPropertyTermScoped&&e.previousContext&&(e=e.previousContext),(t=t||{}).vocab){const t=e.mappings.get(n);if(null===t)return null;if(t)return t["@id"]}const s=n.indexOf(":");if(-1!==s){const t=n.substr(0,s),a=n.substr(s+1);if("_"===t||0===a.indexOf("//"))return n;if(o&&o.hasOwnProperty(t)&&api.createTermDefinition(e,o,t,r,i),e.mappings.has(t)){return e.mappings.get(t)["@id"]+a}return n}return t.vocab&&"@vocab"in e?e["@vocab"]+n:t.base?prependBase(e["@base"],n):n}async function _retrieveContextUrls(e,n){const t=util.normalizeDocumentLoader(n.documentLoader);return await async function e(t,o,r){if(o.size>MAX_CONTEXT_URLS)throw new JsonLdError("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"loading remote context failed",max:MAX_CONTEXT_URLS});const i=new Map;_findContextUrls(t,i,!1,n.base);if(0===i.size)return;const s=[...i.keys()].filter(e=>!1===i.get(e));return Promise.all(s.map(async s=>{if(o.has(s))throw new JsonLdError("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"recursive context inclusion",url:s});const a=new Set(o);let c,d;a.add(s);try{c=await r(s),d=c.document||null,_isString(d)&&(d=JSON.parse(d))}catch(e){throw new JsonLdError("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:s,cause:e})}if(!_isObject(d))throw new JsonLdError("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:s});d="@context"in d?{"@context":d["@context"]}:{"@context":{}},c.contextUrl&&(_isArray(d["@context"])||(d["@context"]=[d["@context"]]),d["@context"].push(c.contextUrl)),await e(d,a,r),i.set(s,d["@context"]),_findContextUrls(t,i,!0,n.base)}))}(e,new Set,t),e}function _findContextUrls(e,n,t,o){if(_isArray(e))for(const r of e)_findContextUrls(r,n,t,o);else if(_isObject(e))for(const r in e){if("@context"!==r){_findContextUrls(e[r],n,t,o);continue}const i=e[r];if(_isArray(i)){let e=i.length;for(let r=0;r<e;++r){const s=i[r];if(_isString(s)){const a=prependBase(o,s),c=n.get(a);t?_isArray(c)?(Array.prototype.splice.apply(i,[r,1].concat(c)),r+=c.length-1,e=i.length):!1!==c&&(i[r]=c):void 0===c&&n.set(a,!1)}else for(const e in s)_isObject(s[e])&&_findContextUrls(s[e],n,t,o)}}else if(_isString(i)){const s=prependBase(o,i),a=n.get(s);t?!1!==a&&(e[r]=a):void 0===a&&n.set(s,!1)}else for(const e in i)_isObject(i[e])&&_findContextUrls(i[e],n,t,o)}}function _deepCompare(e,n){if(!e||"object"!=typeof e||!n||"object"!=typeof n)return e===n;const t=Array.isArray(e);if(t!==Array.isArray(n))return!1;if(t){if(e.length!==n.length)return!1;for(let t=0;t<e.length;++t)if(!_deepCompare(e[t],n[t]))return!1;return!0}const o=Object.keys(e),r=Object.keys(n);if(o.length!==r.length)return!1;for(const t in e){let o=e[t],r=n[t];if("@container"===t&&Array.isArray(o)&&Array.isArray(r)&&(o=o.slice().sort(),r=r.slice().sort()),!_deepCompare(o,r))return!1}return!0}module.exports=api,api.cache=new ActiveContextCache,api.process=(({activeCtx:e,localCtx:n,options:t,isPropertyTermScopedContext:o=!1,isTypeScopedContext:r=!1})=>{_isObject(n)&&"@context"in n&&_isArray(n["@context"])&&(n=n["@context"]);const i=_asArray(n);if(0===i.length)return e;const s=e.previousContext||e;if(o&&e.previousContext)return(e=e.clone()).isPropertyTermScoped=!0,e.previousContext=api.process({activeCtx:e.previousContext,localCtx:i,options:t,isPropertyTermScopedContext:o}),e;let a=e;for(let c=0;c<i.length;++c){let d=i[c];if(e=a,null===d){if(!o&&0!==Object.keys(e.protected).length){const o=t&&t.protectedMode||"error";if("error"===o)throw new JsonLdError("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===o){console.warn("WARNING: invalid context nullification");const n=e;a=e=api.getInitialContext(t).clone();for(const[t,o]of Object.entries(n.protected))o&&(e.mappings[t]=util.clone(n.mappings[t]));e.protected=util.clone(n.protected),api.cache&&api.cache.set(n,d,a);continue}throw new JsonLdError("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:n,protectedMode:o})}a=e=api.getInitialContext(t).clone(),r&&(a.previousContext=s.clone());continue}if(api.cache){const n=api.cache.get(e,d);if(n){a=e=n;continue}}if(_isObject(d)&&"@context"in d&&(d=d["@context"]),!_isObject(d))throw new JsonLdError("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:d});a=a.clone();const l=new Map;if("@version"in d){if(1.1!==d["@version"])throw new JsonLdError("Unsupported JSON-LD version: "+d["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:d});if(e.processingMode&&"json-ld-1.0"===e.processingMode)throw new JsonLdError("@version: "+d["@version"]+" not compatible with "+e.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:d});a.processingMode="json-ld-1.1",a["@version"]=d["@version"],l.set("@version",!0)}if(a.processingMode=a.processingMode||e.processingMode||"json-ld-1.0","@base"in d){let n=d["@base"];if(null===n);else if(_isAbsoluteIri(n))n=parseUrl(n);else{if(!_isRelativeIri(n))throw new JsonLdError('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:d});n=parseUrl(prependBase(e["@base"].href,n))}a["@base"]=n,l.set("@base",!0)}if("@vocab"in d){const e=d["@vocab"];if(null===e)delete a["@vocab"];else{if(!_isString(e))throw new JsonLdError('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:d});if(!_isAbsoluteIri(e))throw new JsonLdError('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:d});a["@vocab"]=e}l.set("@vocab",!0)}if("@language"in d){const e=d["@language"];if(null===e)delete a["@language"];else{if(!_isString(e))throw new JsonLdError('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:d});a["@language"]=e.toLowerCase()}l.set("@language",!0)}l.set("@protected",d["@protected"]||!1);for(const e in d)api.createTermDefinition(a,d,e,l,t,o);r&&!a.previousContext&&(a.previousContext=s.clone()),api.cache&&api.cache.set(e,d,a)}return a}),api.createTermDefinition=((e,n,t,o,r,i=!1)=>{if(o.has(t)){if(o.get(t))return;throw new JsonLdError("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:n,term:t})}if(o.set(t,!1),api.isKeyword(t))throw new JsonLdError("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:n,term:t});if(""===t)throw new JsonLdError("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:n});const s=e.mappings.get(t);let a;if(e.mappings.has(t)&&e.mappings.delete(t),n.hasOwnProperty(t)&&(a=n[t]),null===a||_isObject(a)&&null===a["@id"])return e.mappings.set(t,null),void o.set(t,!0);let c=!1;if(_isString(a)&&(c=!0,a={"@id":a}),!_isObject(a))throw new JsonLdError("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:n});const d={};e.mappings.set(t,d),d.reverse=!1;const l=["@container","@id","@language","@reverse","@type"];api.processingMode(e,1.1)&&l.push("@context","@nest","@prefix","@protected");for(const e in a)if(!l.includes(e))throw new JsonLdError("Invalid JSON-LD syntax; a term definition must not contain "+e,"jsonld.SyntaxError",{code:"invalid term definition",context:n});const p=t.indexOf(":");if(d._termHasColon=-1!==p,"@reverse"in a){if("@id"in a)throw new JsonLdError("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:n});if("@nest"in a)throw new JsonLdError("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:n});const t=a["@reverse"];if(!_isString(t))throw new JsonLdError("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:n});const i=_expandIri(e,t,{vocab:!0,base:!1},n,o,r);if(!_isAbsoluteIri(i))throw new JsonLdError("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:n});d["@id"]=i,d.reverse=!0}else if("@id"in a){let i=a["@id"];if(!_isString(i))throw new JsonLdError("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:n});if(i!==t){if(i=_expandIri(e,i,{vocab:!0,base:!1},n,o,r),!_isAbsoluteIri(i)&&!api.isKeyword(i))throw new JsonLdError("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:n});d["@id"]=i,d._prefix=!d._termHasColon&&i.match(/[:\/\?#\[\]@]$/)&&(c||api.processingMode(e,1))}}if(!("@id"in d))if(d._termHasColon){const i=t.substr(0,p);if(n.hasOwnProperty(i)&&api.createTermDefinition(e,n,i,o,r),e.mappings.has(i)){const n=t.substr(p+1);d["@id"]=e.mappings.get(i)["@id"]+n}else d["@id"]=t}else{if(!("@vocab"in e))throw new JsonLdError("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:n,term:t});d["@id"]=e["@vocab"]+t}if((!0===a["@protected"]||!0===o.get("@protected")&&!1!==a["@protected"])&&(e.protected[t]=!0,d.protected=!0),o.set(t,!0),"@type"in a){let t=a["@type"];if(!_isString(t))throw new JsonLdError("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:n});if("@id"!==t&&"@vocab"!==t){if(t=_expandIri(e,t,{vocab:!0,base:!1},n,o,r),!_isAbsoluteIri(t))throw new JsonLdError("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:n});if(0===t.indexOf("_:"))throw new JsonLdError("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:n})}d["@type"]=t}if("@container"in a){const t=_isString(a["@container"])?[a["@container"]]:a["@container"]||[],o=["@list","@set","@index","@language"];let r=!0;const i=t.includes("@set");if(api.processingMode(e,1.1))if(o.push("@graph","@id","@type"),t.includes("@list")){if(1!==t.length)throw new JsonLdError("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:n})}else if(t.includes("@graph")){if(t.some(e=>"@graph"!==e&&"@id"!==e&&"@index"!==e&&"@set"!==e))throw new JsonLdError("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:n})}else r&=t.length<=(i?2:1);else r&=!_isArray(a["@container"]),r&=t.length<=1;if(r&=t.every(e=>o.includes(e)),!(r&=!(i&&t.includes("@list"))))throw new JsonLdError("Invalid JSON-LD syntax; @context @container value must be one of the following: "+o.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:n});if(d.reverse&&!t.every(e=>["@index","@set"].includes(e)))throw new JsonLdError("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:n});d["@container"]=t}if("@context"in a&&(d["@context"]=a["@context"]),"@language"in a&&!("@type"in a)){let e=a["@language"];if(null!==e&&!_isString(e))throw new JsonLdError("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:n});null!==e&&(e=e.toLowerCase()),d["@language"]=e}if("@prefix"in a){if(d._termHasColon)throw new JsonLdError("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:n});if("boolean"!=typeof a["@prefix"])throw new JsonLdError("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:n});d._prefix=!0===a["@prefix"]}if("@nest"in a){const e=a["@nest"];if(!_isString(e)||"@nest"!==e&&0===e.indexOf("@"))throw new JsonLdError("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:n});d["@nest"]=e}const u=d["@id"];if("@context"===u||"@preserve"===u)throw new JsonLdError("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:n});if(s&&s.protected&&!i&&(e.protected[t]=!0,d.protected=!0,!_deepCompare(s,d))){const e=r&&r.protectedMode||"error";if("error"===e)throw new JsonLdError("Invalid JSON-LD syntax; tried to redefine a protected term.","jsonld.SyntaxError",{code:"protected term redefinition",context:n,term:t});if("warn"===e)return void console.warn("WARNING: protected term redefinition",{term:t});throw new JsonLdError("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:n,term:t,protectedMode:e})}}),api.expandIri=((e,n,t,o)=>_expandIri(e,n,t,void 0,void 0,o)),api.getInitialContext=(e=>{const n=parseUrl(e.base||""),t=JSON.stringify({base:n,processingMode:e.processingMode}),o=INITIAL_CONTEXT_CACHE.get(t);if(o)return o;const r={"@base":n,processingMode:e.processingMode,mappings:new Map,inverse:null,getInverse:function(){const e=this;if(e.inverse)return e.inverse;const n=e.inverse={},t=e.fastCurieMap={},o={},r=e["@language"]||"@none",a=e.mappings,c=[...a.keys()].sort(_compareShortestLeast);for(const e of c){const i=a.get(e);if(null===i)continue;let c=i["@container"]||"@none";c=[].concat(c).sort().join("");const d=_asArray(i["@id"]);for(const a of d){let d=n[a];const l=api.isKeyword(a);if(d)l||i._termHasColon||o[a].push(e);else if(n[a]=d={},!l&&!i._termHasColon){o[a]=[e];const n={iri:a,terms:o[a]};a[0]in t?t[a[0]].push(n):t[a[0]]=[n]}if(d[c]||(d[c]={"@language":{},"@type":{},"@any":{}}),d=d[c],s(e,d["@any"],"@none"),i.reverse)s(e,d["@type"],"@reverse");else if("@type"in i)s(e,d["@type"],i["@type"]);else if("@language"in i){const n=i["@language"]||"@null";s(e,d["@language"],n)}else s(e,d["@language"],r),s(e,d["@type"],"@none"),s(e,d["@language"],"@none")}}for(const e in t)i(t,e,1);return n},clone:function(){const e={};e["@base"]=this["@base"],e.mappings=util.clone(this.mappings),e.clone=this.clone,e.inverse=null,e.getInverse=this.getInverse,e.protected=util.clone(this.protected),this.previousContext&&(e.isPropertyTermScoped=this.previousContext.isPropertyTermScoped,e.previousContext=this.previousContext.clone());e.revertTypeScopedContext=this.revertTypeScopedContext,"@language"in this&&(e["@language"]=this["@language"]);"@vocab"in this&&(e["@vocab"]=this["@vocab"]);return e},revertTypeScopedContext:function(){if(!this.previousContext)return this;return this.previousContext.clone()},protected:{}};return 1e4===INITIAL_CONTEXT_CACHE.size&&INITIAL_CONTEXT_CACHE.clear(),INITIAL_CONTEXT_CACHE.set(t,r),r;function i(e,n,t){const o=e[n],r=e[n]={};let s,a;for(const e of o)(a=t>=(s=e.iri).length?"":s[t])in r?r[a].push(e):r[a]=[e];for(const e in r)""!==e&&i(r,e,t+1)}function s(e,n,t){n.hasOwnProperty(t)||(n[t]=e)}}),api.getContextValue=((e,n,t)=>{if(null===n){if("@context"===t)return;return null}if(e.mappings.has(n)){const o=e.mappings.get(n);if(_isUndefined(t))return o;if(o.hasOwnProperty(t))return o[t]}return"@language"===t&&e.hasOwnProperty(t)?e[t]:"@context"!==t?null:void 0}),api.getAllContexts=(async(e,n)=>_retrieveContextUrls(e,n)),api.processingMode=((e,n)=>n.toString()>="1.1"?e.processingMode&&e.processingMode>="json-ld-"+n.toString():!e.processingMode||"json-ld-1.0"===e.processingMode),api.isKeyword=(e=>{if(!_isString(e))return!1;switch(e){case"@base":case"@container":case"@context":case"@default":case"@embed":case"@explicit":case"@graph":case"@id":case"@index":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1});

},{"./ActiveContextCache":2,"./JsonLdError":3,"./types":21,"./url":22,"./util":23}],11:[function(require,module,exports){
"use strict";const{parseLinkHeader:parseLinkHeader,buildHeaders:buildHeaders}=require("../util"),{LINK_HEADER_REL:LINK_HEADER_REL}=require("../constants"),JsonLdError=require("../JsonLdError"),RequestQueue=require("../RequestQueue");function _request(e,r){return new Promise((t,d)=>{e(r,(e,r,o)=>{e?d(e):t({res:r,body:o})})})}module.exports=(({secure:e,strictSSL:r=!0,maxRedirects:t=-1,request:d,headers:o={}}={strictSSL:!0,maxRedirects:-1,headers:{}})=>{o=buildHeaders(o),d=d||require("request");const n=require("http");return(new RequestQueue).wrapLoader(function(s){return async function s(i,u){if(0!==i.indexOf("http:")&&0!==i.indexOf("https:"))throw new JsonLdError('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:i});if(e&&0!==i.indexOf("https"))throw new JsonLdError('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:i});let a=null;if(null!==a)return a;let c;try{c=await _request(d,{url:i,headers:o,strictSSL:r,followRedirect:!1})}catch(e){throw new JsonLdError("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:i,cause:e})}const{res:l,body:h}=c;a={contextUrl:null,documentUrl:i,document:h||null};const L=n.STATUS_CODES[l.statusCode];if(l.statusCode>=400)throw new JsonLdError("URL could not be dereferenced: "+L,"jsonld.InvalidUrl",{code:"loading document failed",url:i,httpStatusCode:l.statusCode});if(l.headers.link&&"application/ld+json"!==l.headers["content-type"]){const e=parseLinkHeader(l.headers.link)[LINK_HEADER_REL];if(Array.isArray(e))throw new JsonLdError("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:i});e&&(a.contextUrl=e.target)}if(l.statusCode>=300&&l.statusCode<400&&l.headers.location){if(u.length===t)throw new JsonLdError("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:i,httpStatusCode:l.statusCode,redirects:u});if(-1!==u.indexOf(i))throw new JsonLdError("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:i,httpStatusCode:l.statusCode,redirects:u});return u.push(i),s(l.headers.location,u)}u.push(i);return a}(s,[])})});

},{"../JsonLdError":3,"../RequestQueue":7,"../constants":9,"../util":23,"http":1,"request":1}],12:[function(require,module,exports){
"use strict";const{parseLinkHeader:parseLinkHeader,buildHeaders:buildHeaders}=require("../util"),{LINK_HEADER_REL:LINK_HEADER_REL}=require("../constants"),JsonLdError=require("../JsonLdError"),RequestQueue=require("../RequestQueue"),REGEX_LINK_HEADER=/(^|(\r\n))link:/i;function _get(e,r,n){const t=new(e=e||XMLHttpRequest);return new Promise((e,o)=>{t.onload=(()=>e(t)),t.onerror=(e=>o(e)),t.open("GET",r,!0);for(const e in n)t.setRequestHeader(e,n[e]);t.send()})}module.exports=(({secure:e,headers:r={},xhr:n}={headers:{}})=>{return r=buildHeaders(r),(new RequestQueue).wrapLoader(async function(t){if(0!==t.indexOf("http:")&&0!==t.indexOf("https:"))throw new JsonLdError('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:t});if(e&&0!==t.indexOf("https"))throw new JsonLdError('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:t});let o;try{o=await _get(n,t,r)}catch(e){throw new JsonLdError("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:t,cause:e})}if(o.status>=400)throw new JsonLdError("URL could not be dereferenced: "+o.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:t,httpStatusCode:o.status});const d={contextUrl:null,documentUrl:t,document:o.response},s=o.getResponseHeader("Content-Type");let a;REGEX_LINK_HEADER.test(o.getAllResponseHeaders())&&(a=o.getResponseHeader("Link"));if(a&&"application/ld+json"!==s){if(a=parseLinkHeader(a)[LINK_HEADER_REL],Array.isArray(a))throw new JsonLdError("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:t});a&&(d.contextUrl=a.target)}return d})});

},{"../JsonLdError":3,"../RequestQueue":7,"../constants":9,"../util":23}],13:[function(require,module,exports){
"use strict";const JsonLdError=require("./JsonLdError"),{isArray:_isArray,isObject:_isObject,isEmptyObject:_isEmptyObject,isString:_isString,isUndefined:_isUndefined}=require("./types"),{isList:_isList,isValue:_isValue,isGraph:_isGraph}=require("./graphTypes"),{expandIri:_expandIri,getContextValue:_getContextValue,isKeyword:_isKeyword,process:_processContext}=require("./context"),{isAbsolute:_isAbsoluteIri}=require("./url"),{addValue:_addValue,asArray:_asArray,getValues:_getValues,validateTypeValue:_validateTypeValue}=require("./util"),api={};function _expandObject({activeCtx:e,activeProperty:t,expandedActiveProperty:n,element:a,expandedParent:i,options:r={},insideList:o,expansionMap:s}){const l=Object.keys(a).sort(),d=[];for(const p of l){let l,c=a[p];if("@context"===p)continue;let u=_expandIri(e,p,{vocab:!0},r);if((null===u||!_isAbsoluteIri(u)&&!_isKeyword(u))&&void 0===(u=s({unmappedProperty:p,activeCtx:e,activeProperty:t,parent:a,options:r,insideList:o,value:c,expandedParent:i})))continue;if(_isKeyword(u)){if("@reverse"===n)throw new JsonLdError("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:c});if(u in i)throw new JsonLdError("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:u})}if("@id"===u){if(!_isString(c)){if(!r.isFrame)throw new JsonLdError('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:c});if(_isObject(c)){if(!_isEmptyObject(c))throw new JsonLdError('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:c})}else{if(!_isArray(c))throw new JsonLdError('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:c});if(!c.every(e=>_isString(e)))throw new JsonLdError('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:c})}}_addValue(i,"@id",_asArray(c).map(t=>_isString(t)?_expandIri(e,t,{base:!0},r):t),{propertyIsArray:r.isFrame});continue}if("@type"===u){_validateTypeValue(c),_addValue(i,"@type",_asArray(c).map(t=>_isString(t)?_expandIri(e.previousContext||e,t,{base:!0,vocab:!0},r):t),{propertyIsArray:r.isFrame});continue}if("@graph"===u&&!_isObject(c)&&!_isArray(c))throw new JsonLdError('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:c});if("@value"===u){if((_isObject(c)||_isArray(c))&&!r.isFrame)throw new JsonLdError('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:c});_addValue(i,"@value",c,{propertyIsArray:r.isFrame});continue}if("@language"===u){if(null===c)continue;if(!_isString(c)&&!r.isFrame)throw new JsonLdError('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:c});c=_asArray(c).map(e=>_isString(e)?e.toLowerCase():e),_addValue(i,"@language",c,{propertyIsArray:r.isFrame});continue}if("@index"===u){if(!_isString(c))throw new JsonLdError('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:c});_addValue(i,"@index",c);continue}if("@reverse"===u){if(!_isObject(c))throw new JsonLdError('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:c});if("@reverse"in(l=api.expand({activeCtx:e,activeProperty:"@reverse",element:c,options:r,expansionMap:s})))for(const e in l["@reverse"])_addValue(i,e,l["@reverse"][e],{propertyIsArray:!0});let t=i["@reverse"]||null;for(const e in l){if("@reverse"===e)continue;null===t&&(t=i["@reverse"]={}),_addValue(t,e,[],{propertyIsArray:!0});const n=l[e];for(let a=0;a<n.length;++a){const i=n[a];if(_isValue(i)||_isList(i))throw new JsonLdError('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:l});_addValue(t,e,i,{propertyIsArray:!0})}}continue}if("@nest"===u){d.push(p);continue}let v=e;const y=_getContextValue(e,p,"@context");_isUndefined(y)||(v=_processContext({activeCtx:e,localCtx:y,isPropertyTermScopedContext:!0,options:r}));const x=_getContextValue(v,p,"@container")||[];if(x.includes("@language")&&_isObject(c))l=_expandLanguageMap(v,c,r);else if(x.includes("@index")&&_isObject(c)){const e=x.includes("@graph");l=_expandIndexMap({activeCtx:v,options:r,activeProperty:p,value:c,expansionMap:s,asGraph:e,indexKey:"@index"})}else if(x.includes("@id")&&_isObject(c)){const e=x.includes("@graph");l=_expandIndexMap({activeCtx:v,options:r,activeProperty:p,value:c,expansionMap:s,asGraph:e,indexKey:"@id"})}else if(x.includes("@type")&&_isObject(c))l=_expandIndexMap({activeCtx:v.revertTypeScopedContext(),options:r,activeProperty:p,value:c,expansionMap:s,asGraph:!1,indexKey:"@type"});else{const e="@list"===u;if(e||"@set"===u){let a=t;if(e&&"@graph"===n&&(a=null),l=api.expand({activeCtx:v,activeProperty:a,element:c,options:r,insideList:e,expansionMap:s}),e&&_isList(l))throw new JsonLdError("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"})}else l=api.expand({activeCtx:v,activeProperty:p,element:c,options:r,insideList:!1,expansionMap:s})}if(null===l&&"@value"!==u&&void 0===(l=s({unmappedValue:c,expandedProperty:u,activeCtx:v,activeProperty:t,parent:a,options:r,insideList:o,key:p,expandedParent:i})))continue;if("@list"!==u&&!_isList(l)&&x.includes("@list")&&(l={"@list":_asArray(l)}),x.includes("@graph")&&!x.some(e=>"@id"===e||"@index"===e)&&(l=_asArray(l).map(e=>_isGraph(e)?e:{"@graph":_asArray(e)})),v.mappings.has(p)&&v.mappings.get(p).reverse){const e=i["@reverse"]=i["@reverse"]||{};l=_asArray(l);for(let t=0;t<l.length;++t){const n=l[t];if(_isValue(n)||_isList(n))throw new JsonLdError('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:l});_addValue(e,u,n,{propertyIsArray:!0})}continue}const _=!["@index","@id","@type","@value","@language"].includes(u);_addValue(i,u,l,{propertyIsArray:_})}for(const l of d){const d=_isArray(a[l])?a[l]:[a[l]];for(const a of d){if(!_isObject(a)||Object.keys(a).some(t=>"@value"===_expandIri(e,t,{vocab:!0},r)))throw new JsonLdError("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:a});_expandObject({activeCtx:e,activeProperty:t,expandedActiveProperty:n,element:a,expandedParent:i,options:r,insideList:o,expansionMap:s})}}}function _expandValue({activeCtx:e,activeProperty:t,value:n,options:a}){if(null==n)return null;const i=_expandIri(e,t,{vocab:!0},a);if("@id"===i)return _expandIri(e,n,{base:!0},a);if("@type"===i)return _expandIri(e,n,{vocab:!0,base:!0},a);const r=_getContextValue(e,t,"@type");if(("@id"===r||"@graph"===i)&&_isString(n))return{"@id":_expandIri(e,n,{base:!0},a)};if("@vocab"===r&&_isString(n))return{"@id":_expandIri(e,n,{vocab:!0,base:!0},a)};if(_isKeyword(i))return n;const o={};if(r&&!["@id","@vocab"].includes(r))o["@type"]=r;else if(_isString(n)){const n=_getContextValue(e,t,"@language");null!==n&&(o["@language"]=n)}return["boolean","number","string"].includes(typeof n)||(n=n.toString()),o["@value"]=n,o}function _expandLanguageMap(e,t,n){const a=[],i=Object.keys(t).sort();for(const r of i){const i=_expandIri(e,r,{vocab:!0},n);let o=t[r];_isArray(o)||(o=[o]);for(const e of o){if(null===e)continue;if(!_isString(e))throw new JsonLdError("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:t});const n={"@value":e};"@none"!==i&&(n["@language"]=r.toLowerCase()),a.push(n)}}return a}function _expandIndexMap({activeCtx:e,options:t,activeProperty:n,value:a,expansionMap:i,asGraph:r,indexKey:o}){const s=[],l=Object.keys(a).sort(),d="@type"===o;for(let p of l){if(d){const n=_getContextValue(e,p,"@context");_isUndefined(n)||(e=_processContext({activeCtx:e,localCtx:n,isTypeScopedContext:!0,options:t}))}let l=a[p];_isArray(l)||(l=[l]);const c=_expandIri(e,p,{vocab:!0},t);"@id"===o?p=_expandIri(e,p,{base:!0},t):d&&(p=c),l=api.expand({activeCtx:e,activeProperty:n,element:l,options:t,insideList:!1,insideIndex:!0,expansionMap:i});for(let e of l)r&&!_isGraph(e)&&(e={"@graph":[e]}),"@type"===o?"@none"===c||(e["@type"]?e["@type"]=[p].concat(e["@type"]):e["@type"]=[p]):"@none"===c||o in e||(e[o]=p),s.push(e)}return s}module.exports=api,api.expand=(({activeCtx:e,activeProperty:t=null,element:n,options:a={},insideList:i=!1,insideIndex:r=!1,typeScopedContext:o=null,expansionMap:s=(()=>void 0)})=>{if(null==n)return null;if("@default"===t&&(a=Object.assign({},a,{isFrame:!1})),!_isArray(n)&&!_isObject(n)){if(!i&&(null===t||"@graph"===_expandIri(e,t,{vocab:!0},a))){const r=s({unmappedValue:n,activeCtx:e,activeProperty:t,options:a,insideList:i});return void 0===r?null:r}return _expandValue({activeCtx:e,activeProperty:t,value:n,options:a})}if(_isArray(n)){let l=[];const d=_getContextValue(e,t,"@container")||[];i=i||d.includes("@list");for(let d=0;d<n.length;++d){let p=api.expand({activeCtx:e,activeProperty:t,element:n[d],options:a,expansionMap:s,insideIndex:r,typeScopedContext:o});if(i&&(_isArray(p)||_isList(p)))throw new JsonLdError("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"});null===p&&void 0===(p=s({unmappedValue:n[d],activeCtx:e,activeProperty:t,parent:n,index:d,options:a,expandedParent:l,insideList:i}))||(_isArray(p)?l=l.concat(p):l.push(p))}return l}const l=_expandIri(e,t,{vocab:!0},a);o=o||(e.previousContext?e:null);let d=Object.keys(n).sort(),p=!r;if(p&&o&&d.length<=2&&!d.includes("@context"))for(const t of d){const n=_expandIri(o,t,{vocab:!0},a);if("@value"===n){p=!1,e=o;break}if("@id"===n&&1===d.length){p=!1;break}}p&&(e=e.revertTypeScopedContext()),"@context"in n&&(e=_processContext({activeCtx:e,localCtx:n["@context"],options:a}));for(const t of d){if("@type"===_expandIri(e,t,{vocab:!0},a)){const i=n[t],r=Array.isArray(i)?i.length>1?i.slice().sort():i:[i];for(const t of r){const n=_getContextValue(e.previousContext||e,t,"@context");_isUndefined(n)||(e=_processContext({activeCtx:e,localCtx:n,options:a,isTypeScopedContext:!0}))}}}let c={};_expandObject({activeCtx:e,activeProperty:t,expandedActiveProperty:l,element:n,expandedParent:c,options:a,insideList:i,typeScopedContext:o,expansionMap:s});let u=(d=Object.keys(c)).length;if("@value"in c){if("@type"in c&&"@language"in c)throw new JsonLdError('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:c});let r=u-1;if("@type"in c&&(r-=1),"@index"in c&&(r-=1),"@language"in c&&(r-=1),0!==r)throw new JsonLdError('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and at most one other property which can be "@type" or "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:c});const o=null===c["@value"]?[]:_asArray(c["@value"]),l=_getValues(c,"@type");if(0===o.length){const r=s({unmappedValue:c,activeCtx:e,activeProperty:t,element:n,options:a,insideList:i});c=void 0!==r?r:null}else{if(!o.every(e=>_isString(e)||_isEmptyObject(e))&&"@language"in c)throw new JsonLdError("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:c});if(!l.every(e=>_isAbsoluteIri(e)&&!(_isString(e)&&0===e.indexOf("_:"))||_isEmptyObject(e)))throw new JsonLdError('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:c})}}else if("@type"in c&&!_isArray(c["@type"]))c["@type"]=[c["@type"]];else if("@set"in c||"@list"in c){if(u>1&&!(2===u&&"@index"in c))throw new JsonLdError('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:c});"@set"in c&&(c=c["@set"],u=(d=Object.keys(c)).length)}else if(1===u&&"@language"in c){const r=s(c,{unmappedValue:c,activeCtx:e,activeProperty:t,element:n,options:a,insideList:i});c=void 0!==r?r:null}if(_isObject(c)&&!a.keepFreeFloatingNodes&&!i&&(null===t||"@graph"===l)&&(0===u||"@value"in c||"@list"in c||1===u&&"@id"in c)){const r=s({unmappedValue:c,activeCtx:e,activeProperty:t,element:n,options:a,insideList:i});c=void 0!==r?r:null}return c});

},{"./JsonLdError":3,"./context":10,"./graphTypes":17,"./types":21,"./url":22,"./util":23}],14:[function(require,module,exports){
"use strict";const{isSubjectReference:_isSubjectReference}=require("./graphTypes"),{createMergedNodeMap:_createMergedNodeMap}=require("./nodeMap"),api={};module.exports=api,api.flatten=(e=>{const r=_createMergedNodeMap(e),t=[],c=Object.keys(r).sort();for(let e=0;e<c.length;++e){const s=r[c[e]];_isSubjectReference(s)||t.push(s)}return t});

},{"./graphTypes":17,"./nodeMap":19}],15:[function(require,module,exports){
"use strict";const{isKeyword:isKeyword}=require("./context"),graphTypes=require("./graphTypes"),types=require("./types"),util=require("./util"),JsonLdError=require("./JsonLdError"),{createNodeMap:_createNodeMap,mergeNodeMapGraphs:_mergeNodeMapGraphs}=require("./nodeMap"),api={};function _createImplicitFrame(e){const t={};for(const r in e)void 0!==e[r]&&(t["@"+r]=[e[r]]);return[t]}function _createsCircularReference(e,t,r){for(let a=r.length-1;a>=0;--a){const s=r[a];if(s.graph===t&&s.subject["@id"]===e["@id"])return!0}return!1}function _getFrameFlag(e,t,r){const a="@"+r;let s=a in e?e[a][0]:t[r];return"embed"===r&&(!0===s?s="@last":!1===s?s="@never":"@always"!==s&&"@never"!==s&&"@link"!==s&&(s="@last")),s}function _validateFrame(e){if(!types.isArray(e)||1!==e.length||!types.isObject(e[0]))throw new JsonLdError("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:e})}function _filterSubjects(e,t,r,a){const s={};for(const i of t){const t=e.graphMap[e.graph][i];_filterSubject(e,t,r,a)&&(s[i]=t)}return s}function _filterSubject(e,t,r,a){let s=!0,i=!1;for(const n in r){let p=!1;const l=util.getValues(t,n),u=0===util.getValues(r,n).length;if(isKeyword(n)){if("@id"!==n&&"@type"!==n)continue;if(s=!1,"@id"===n){if(r["@id"].length>=0&&!types.isEmptyObject(r["@id"][0]))return r["@id"].includes(l[0]);p=!0;continue}if("@type"in r)if(u){if(l.length>0)return!1;p=!0}else{if(1!==r["@type"].length||!types.isEmptyObject(r["@type"][0])){for(const e of r["@type"])if(l.some(t=>t===e))return!0;return!1}p=l.length>0}}const o=util.getValues(r,n)[0];let c=!1;if(o&&(_validateFrame([o]),c="@default"in o),s=!1,0!==l.length||!c){if(l.length>0&&u)return!1;if(void 0===o){if(l.length>0)return!1;p=!0}else if(types.isObject(o))p=l.length>0;else if(graphTypes.isValue(o))p=l.some(e=>_valueMatch(o,e));else if(graphTypes.isSubject(o)||graphTypes.isSubjectReference(o))p=l.some(t=>_nodeMatch(e,o,t,a));else if(graphTypes.isList(o)){const t=o["@list"][0];if(graphTypes.isList(l[0])){const r=l[0]["@list"];graphTypes.isValue(t)?p=r.some(e=>_valueMatch(t,e)):(graphTypes.isSubject(t)||graphTypes.isSubjectReference(t))&&(p=r.some(r=>_nodeMatch(e,t,r,a)))}else p=!1}if(!p&&a.requireAll)return!1;i=i||p}}return s||i}function _removeEmbed(e,t){const r=e.uniqueEmbeds[e.graph],a=r[t],s=a.parent,i=a.property,n={"@id":t};if(types.isArray(s)){for(let e=0;e<s.length;++e)if(util.compareValues(s[e],n)){s[e]=n;break}}else{const e=types.isArray(s[i]);util.removeValue(s,i,n,{propertyIsArray:e}),util.addValue(s,i,n,{propertyIsArray:e})}const p=e=>{const t=Object.keys(r);for(const a of t)a in r&&types.isObject(r[a].parent)&&r[a].parent["@id"]===e&&(delete r[a],p(a))};p(t)}function _addFrameOutput(e,t,r){types.isObject(e)?util.addValue(e,t,r,{propertyIsArray:!0}):e.push(r)}function _nodeMatch(e,t,r,a){if(!("@id"in r))return!1;const s=e.subjects[r["@id"]];return s&&_filterSubject(e,s,t,a)}function _valueMatch(e,t){const r=t["@value"],a=t["@type"],s=t["@language"],i=e["@value"]?types.isArray(e["@value"])?e["@value"]:[e["@value"]]:[],n=e["@type"]?types.isArray(e["@type"])?e["@type"]:[e["@type"]]:[],p=e["@language"]?types.isArray(e["@language"])?e["@language"]:[e["@language"]]:[];return 0===i.length&&0===n.length&&0===p.length||!(!i.includes(r)&&!types.isEmptyObject(i[0]))&&(!!(!a&&0===n.length||n.includes(a)||a&&types.isEmptyObject(n[0]))&&!!(!s&&0===p.length||p.includes(s)||s&&types.isEmptyObject(p[0])))}module.exports=api,api.frameMergedOrDefault=((e,t,r)=>{const a={options:r,graph:"@default",graphMap:{"@default":{}},graphStack:[],subjectStack:[],link:{},bnodeMap:{}},s=new util.IdentifierIssuer("_:b");_createNodeMap(e,a.graphMap,"@default",s),r.merged&&(a.graphMap["@merged"]=_mergeNodeMapGraphs(a.graphMap),a.graph="@merged"),a.subjects=a.graphMap[a.graph];const i=[];return api.frame(a,Object.keys(a.subjects).sort(),t,i),r.pruneBlankNodeIdentifiers&&(r.bnodesToClear=Object.keys(a.bnodeMap).filter(e=>1===a.bnodeMap[e].length)),i}),api.frame=((e,t,r,a,s=null)=>{_validateFrame(r),r=r[0];const i=e.options,n={embed:_getFrameFlag(r,i,"embed"),explicit:_getFrameFlag(r,i,"explicit"),requireAll:_getFrameFlag(r,i,"requireAll")},p=_filterSubjects(e,t,r,n),l=Object.keys(p).sort();for(const t of l){const l=p[t];if("@link"===n.embed&&t in e.link){_addFrameOutput(a,s,e.link[t]);continue}null===s?e.uniqueEmbeds={[e.graph]:{}}:e.uniqueEmbeds[e.graph]=e.uniqueEmbeds[e.graph]||{};const u={};if(u["@id"]=t,0===t.indexOf("_:")&&util.addValue(e.bnodeMap,t,u,{propertyIsArray:!0}),e.link[t]=u,"@never"===n.embed||_createsCircularReference(l,e.graph,e.subjectStack))_addFrameOutput(a,s,u);else{if("@last"===n.embed&&(t in e.uniqueEmbeds[e.graph]&&_removeEmbed(e,t),e.uniqueEmbeds[e.graph][t]={parent:a,property:s}),e.subjectStack.push({subject:l,graph:e.graph}),t in e.graphMap){let a=!1,s=null;"@graph"in r?(s=r["@graph"][0],types.isObject(s)||(s={}),a=!("@merged"===t||"@default"===t)):(a="@merged"!==e.graph,s={}),a&&(e.graphStack.push(e.graph),e.graph=t,api.frame(e,Object.keys(e.graphMap[t]).sort(),[s],u,"@graph"),e.graph=e.graphStack.pop)}for(const t of Object.keys(l).sort())if(isKeyword(t)){if(u[t]=util.clone(l[t]),"@type"===t)for(const t of l["@type"])0===t.indexOf("_:")&&util.addValue(e.bnodeMap,t,u,{propertyIsArray:!0})}else if(!n.explicit||t in r)for(let a of l[t]){const s=t in r?r[t]:_createImplicitFrame(n);if(graphTypes.isList(a)){const s={"@list":[]};_addFrameOutput(u,t,s);const i=a["@list"];for(const p in i)if(a=i[p],graphTypes.isSubjectReference(a)){const i=t in r?r[t][0]["@list"]:_createImplicitFrame(n);api.frame(e,[a["@id"]],i,s,"@list")}else _addFrameOutput(s,"@list",util.clone(a))}else graphTypes.isSubjectReference(a)?api.frame(e,[a["@id"]],s,u,t):_valueMatch(s[0],a)&&_addFrameOutput(u,t,util.clone(a))}for(const e of Object.keys(r).sort()){if(isKeyword(e))continue;const t=r[e][0]||{};if(!(_getFrameFlag(t,i,"omitDefault")||e in u)){let r="@null";"@default"in t&&(r=util.clone(t["@default"])),types.isArray(r)||(r=[r]),u[e]=[{"@preserve":r}]}}if("@reverse"in r)for(const a of Object.keys(r["@reverse"]).sort()){const i=r["@reverse"][a];for(const r of Object.keys(e.subjects)){util.getValues(e.subjects[r],a).some(e=>e["@id"]===t)&&(u["@reverse"]=u["@reverse"]||{},util.addValue(u["@reverse"],a,[],{propertyIsArray:!0}),api.frame(e,[r],i,u["@reverse"][a],s))}}_addFrameOutput(a,s,u),e.subjectStack.pop()}}});

},{"./JsonLdError":3,"./context":10,"./graphTypes":17,"./nodeMap":19,"./types":21,"./util":23}],16:[function(require,module,exports){
"use strict";const graphTypes=require("./graphTypes"),types=require("./types"),util=require("./util"),{RDF_LIST:RDF_LIST,RDF_FIRST:RDF_FIRST,RDF_REST:RDF_REST,RDF_NIL:RDF_NIL,RDF_TYPE:RDF_TYPE,XSD_BOOLEAN:XSD_BOOLEAN,XSD_DOUBLE:XSD_DOUBLE,XSD_INTEGER:XSD_INTEGER,XSD_STRING:XSD_STRING}=require("./constants"),api={};function _RDFToObject(e,t){if(e.termType.endsWith("Node"))return{"@id":e.value};const s={"@value":e.value};if(e.language)s["@language"]=e.language;else{let a=e.datatype.value;if(a||(a=XSD_STRING),t){if(a===XSD_BOOLEAN)"true"===s["@value"]?s["@value"]=!0:"false"===s["@value"]&&(s["@value"]=!1);else if(types.isNumeric(s["@value"]))if(a===XSD_INTEGER){const e=parseInt(s["@value"],10);e.toFixed(0)===s["@value"]&&(s["@value"]=e)}else a===XSD_DOUBLE&&(s["@value"]=parseFloat(s["@value"]));[XSD_BOOLEAN,XSD_INTEGER,XSD_DOUBLE,XSD_STRING].includes(a)||(s["@type"]=a)}else a!==XSD_STRING&&(s["@type"]=a)}return s}module.exports=api,api.fromRDF=(async(e,{useRdfType:t=!1,useNativeTypes:s=!1})=>{const a={},u={"@default":a},r={};for(const i of e){const e="DefaultGraph"===i.graph.termType?"@default":i.graph.value;e in u||(u[e]={}),"@default"===e||e in a||(a[e]={"@id":e});const l=u[e],n=i.subject.value,o=i.predicate.value,p=i.object;n in l||(l[n]={"@id":n});const R=l[n],D=p.termType.endsWith("Node");if(!D||p.value in l||(l[p.value]={"@id":p.value}),o===RDF_TYPE&&!t&&D){util.addValue(R,"@type",p.value,{propertyIsArray:!0});continue}const c=_RDFToObject(p,s);if(util.addValue(R,o,c,{propertyIsArray:!0}),D)if(p.value===RDF_NIL){const e=l[p.value];"usages"in e||(e.usages=[]),e.usages.push({node:R,property:o,value:c})}else p.value in r?r[p.value]=!1:r[p.value]={node:R,property:o,value:c}}for(const e in u){const t=u[e];if(!(RDF_NIL in t))continue;const s=t[RDF_NIL];if(s.usages){for(let e of s.usages){let s=e.node,a=e.property,u=e.value;const i=[],l=[];let n=Object.keys(s).length;for(;a===RDF_REST&&types.isObject(r[s["@id"]])&&types.isArray(s[RDF_FIRST])&&1===s[RDF_FIRST].length&&types.isArray(s[RDF_REST])&&1===s[RDF_REST].length&&(3===n||4===n&&types.isArray(s["@type"])&&1===s["@type"].length&&s["@type"][0]===RDF_LIST)&&(i.push(s[RDF_FIRST][0]),l.push(s["@id"]),s=(e=r[s["@id"]]).node,a=e.property,u=e.value,n=Object.keys(s).length,graphTypes.isBlankNode(s)););if(a===RDF_FIRST){if(s["@id"]===RDF_NIL)continue;RDF_REST in t[u["@id"]]&&(u=t[u["@id"]][RDF_REST][0]),i.pop(),l.pop()}delete u["@id"],u["@list"]=i.reverse();for(const e of l)delete t[e]}delete s.usages}}const i=[],l=Object.keys(a).sort();for(const e of l){const t=a[e];if(e in u){const s=t["@graph"]=[],a=u[e],r=Object.keys(a).sort();for(const e of r){const t=a[e];graphTypes.isSubjectReference(t)||s.push(t)}}graphTypes.isSubjectReference(t)||i.push(t)}return i});

},{"./constants":9,"./graphTypes":17,"./types":21,"./util":23}],17:[function(require,module,exports){
"use strict";const types=require("./types"),api={};module.exports=api,api.isSubject=(i=>{if(types.isObject(i)&&!("@value"in i||"@set"in i||"@list"in i)){return Object.keys(i).length>1||!("@id"in i)}return!1}),api.isSubjectReference=(i=>types.isObject(i)&&1===Object.keys(i).length&&"@id"in i),api.isValue=(i=>types.isObject(i)&&"@value"in i),api.isList=(i=>types.isObject(i)&&"@list"in i),api.isGraph=(i=>types.isObject(i)&&"@graph"in i&&1===Object.keys(i).filter(i=>"@id"!==i&&"@index"!==i).length),api.isSimpleGraph=(i=>api.isGraph(i)&&!("@id"in i)),api.isBlankNode=(i=>!!types.isObject(i)&&("@id"in i?0===i["@id"].indexOf("_:"):0===Object.keys(i).length||!("@value"in i||"@set"in i||"@list"in i)));

},{"./types":21}],18:[function(require,module,exports){
(function (process,global){
const canonize=require("rdf-canonize"),util=require("./util"),IdentifierIssuer=util.IdentifierIssuer,JsonLdError=require("./JsonLdError"),NQuads=require("./NQuads"),Rdfa=require("./Rdfa"),{expand:_expand}=require("./expand"),{flatten:_flatten}=require("./flatten"),{fromRDF:_fromRDF}=require("./fromRdf"),{toRDF:_toRDF}=require("./toRdf"),{frameMergedOrDefault:_frameMergedOrDefault}=require("./frame"),{isArray:_isArray,isObject:_isObject,isString:_isString}=require("./types"),{isSubjectReference:_isSubjectReference}=require("./graphTypes"),{getInitialContext:_getInitialContext,process:_processContext,getAllContexts:_getAllContexts}=require("./context"),{compact:_compact,compactIri:_compactIri,removePreserve:_removePreserve}=require("./compact"),{createNodeMap:_createNodeMap,createMergedNodeMap:_createMergedNodeMap,mergeNodeMaps:_mergeNodeMaps}=require("./nodeMap"),_nodejs="undefined"!=typeof process&&process.versions&&process.versions.node,_browser=!_nodejs&&("undefined"!=typeof window||"undefined"!=typeof self),wrapper=function(e){e.compact=util.callbackify(async function(t,o,r){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===o)throw new JsonLdError("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===t)return null;let a;(r=n(r,{base:_isString(t)?t:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new IdentifierIssuer("_:b")})).link&&(r.skipExpansion=!0),r.compactToRelative||delete r.base,a=r.skipExpansion?t:await e.expand(t,r);const i=await e.processContext(_getInitialContext(r),o,r);let c=_compact({activeCtx:i,element:a,options:r,compactionMap:r.compactionMap});r.compactArrays&&!r.graph&&_isArray(c)?1===c.length?c=c[0]:0===c.length&&(c={}):r.graph&&_isObject(c)&&(c=[c]),_isObject(o)&&"@context"in o&&(o=o["@context"]),o=util.clone(o),_isArray(o)||(o=[o]);const s=o;o=[];for(let e=0;e<s.length;++e)(!_isObject(s[e])||Object.keys(s[e]).length>0)&&o.push(s[e]);const l=o.length>0;if(1===o.length&&(o=o[0]),_isArray(c)){const e=_compactIri({activeCtx:i,iri:"@graph",relativeTo:{vocab:!0}}),t=c;c={},l&&(c["@context"]=o),c[e]=t}else if(_isObject(c)&&l){const e=c;c={"@context":o};for(const t in e)c[t]=e[t]}if(r.framing){const e=_compactIri({activeCtx:i,iri:"@graph",relativeTo:{vocab:!0}});r.link={},c[e]=_removePreserve(i,c[e],r)}return c}),e.expand=util.callbackify(async function(t,o){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");!1===(o=n(o,{keepFreeFloatingNodes:!1})).expansionMap&&(o.expansionMap=void 0);const r={},a=[];if("expandContext"in o){const e=util.clone(o.expandContext);_isObject(e)&&"@context"in e?r.expandContext=e:r.expandContext={"@context":e},a.push(r.expandContext)}let i;if(_isString(t)){const n=await e.get(t,o);i=n.documentUrl,r.input=n.document,n.contextUrl&&(r.remoteContext={"@context":n.contextUrl},a.push(r.remoteContext))}else r.input=util.clone(t);"base"in o||(o.base=i||""),await _getAllContexts(r,o);let c=_getInitialContext(o);a.forEach(e=>{c=_processContext({activeCtx:c,localCtx:e,options:o})});let s=_expand({activeCtx:c,element:r.input,options:o,expansionMap:o.expansionMap});return _isObject(s)&&"@graph"in s&&1===Object.keys(s).length?s=s["@graph"]:null===s&&(s=[]),_isArray(s)||(s=[s]),s}),e.flatten=util.callbackify(async function(t,o,r){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");o="function"==typeof o?null:o||null,r=n(r,{base:_isString(t)?t:""});const a=await e.expand(t,r),i=_flatten(a);return null===o?i:(r.graph=!0,r.skipExpansion=!0,await e.compact(i,o,r))}),e.frame=util.callbackify(async function(t,o,r){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(r=n(r,{base:_isString(t)?t:"",embed:"@last",explicit:!1,requireAll:!0,omitDefault:!1,pruneBlankNodeIdentifiers:!0,bnodesToClear:[]}),_isString(o)){const t=await e.get(o,r);if(o=t.document,t.contextUrl){let e=o["@context"];e?_isArray(e)?e.push(t.contextUrl):e=[e,t.contextUrl]:e=t.contextUrl,o["@context"]=e}}const a=o&&o["@context"]||{},i=await e.expand(t,r),c=util.clone(r);c.isFrame=!0,c.keepFreeFloatingNodes=!0;const s=await e.expand(o,c);let l;return c.merged=!("@graph"in o),l=_frameMergedOrDefault(i,s,c),c.graph=!0,c.skipExpansion=!0,c.link={},c.framing=!0,await e.compact(l,a,c)}),e.link=util.callbackify(async function(t,n,o){const r={};return n&&(r["@context"]=n),r["@embed"]="@link",e.frame(t,r,o)}),e.normalize=e.canonize=util.callbackify(async function(t,o){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(o=n(o,{base:_isString(t)?t:"",algorithm:"URDNA2015",skipExpansion:!1}))){if("application/n-quads"!==o.inputFormat&&"application/nquads"!==o.inputFormat)throw new JsonLdError("Unknown canonicalization input format.","jsonld.CanonizeError");const e=NQuads.parse(t);return canonize.canonize(e,o)}const r=util.clone(o);delete r.format,r.produceGeneralizedRdf=!1;const a=await e.toRDF(t,r);return canonize.canonize(a,o)}),e.fromRDF=util.callbackify(async function(e,o){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");o=n(o,{format:_isString(e)?"application/n-quads":void 0});let r,{format:a,rdfParser:i}=o;if(a){if(!(i=i||t[a]))throw new JsonLdError("Unknown input format.","jsonld.UnknownFormat",{format:a})}else i=(()=>e);return r=i.length>1?new Promise((t,n)=>{i(e,(e,o)=>{e?n(e):t(o)})}):Promise.resolve(i(e)),r=await r,Array.isArray(r)||(r=NQuads.legacyDatasetToQuads(r)),_fromRDF(r,o)}),e.toRDF=util.callbackify(async function(t,o){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let r;r=(o=n(o,{base:_isString(t)?t:"",skipExpansion:!1})).skipExpansion?t:await e.expand(t,o);const a=_toRDF(r,o);if(o.format){if("application/n-quads"===o.format||"application/nquads"===o.format)return await NQuads.serialize(a);throw new JsonLdError("Unknown output format.","jsonld.UnknownFormat",{format:o.format})}return a}),e.createNodeMap=util.callbackify(async function(t,o){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");o=n(o,{base:_isString(t)?t:""});const r=await e.expand(t,o);return _createMergedNodeMap(r,o)}),e.merge=util.callbackify(async function(t,o,r){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!_isArray(t))throw new TypeError('Could not merge, "docs" must be an array.');o="function"==typeof o?null:o||null,r=n(r,{});const a=await Promise.all(t.map(t=>{const n=Object.assign({},r);return e.expand(t,n)}));let i=!0;"mergeNodes"in r&&(i=r.mergeNodes);const c=r.issuer||new IdentifierIssuer("_:b"),s={"@default":{}};for(let e=0;e<a.length;++e){const t=util.relabelBlankNodes(a[e],{issuer:new IdentifierIssuer("_:b"+e+"-")}),n=i||0===e?s:{"@default":{}};if(_createNodeMap(t,n,"@default",c),n!==s)for(const e in n){const t=n[e];if(!(e in s)){s[e]=t;continue}const o=s[e];for(const e in t)e in o||(o[e]=t[e])}}const l=_mergeNodeMaps(s),u=[],d=Object.keys(l).sort();for(let e=0;e<d.length;++e){const t=l[d[e]];_isSubjectReference(t)||u.push(t)}return null===o?u:(r.graph=!0,r.skipExpansion=!0,await e.compact(u,o,r))}),Object.defineProperty(e,"documentLoader",{get:()=>e._documentLoader,set:t=>e._documentLoader=util.normalizeDocumentLoader(t)}),e.documentLoader=(async e=>{throw new JsonLdError("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:e})}),e.loadDocument=util.callbackify(async function(){return e.documentLoader.apply(null,arguments)}),e.get=util.callbackify(async function(t,n){let o;o="function"==typeof n.documentLoader?util.normalizeDocumentLoader(n.documentLoader):e.documentLoader;const r=await o(t);try{if(!r.document)throw new JsonLdError("No remote document found at the given URL.","jsonld.NullRemoteDocument");_isString(r.document)&&(r.document=JSON.parse(r.document))}catch(e){throw new JsonLdError("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:r})}return r}),e.processContext=util.callbackify(async function(e,t,o){if(o=n(o,{base:""}),null===t)return _getInitialContext(o);t=util.clone(t),_isObject(t)&&"@context"in t||(t={"@context":t});const r=await _getAllContexts(t,o);return _processContext({activeCtx:e,localCtx:r,options:o})}),e.getContextValue=require("./context").getContextValue,e.documentLoaders={},e.documentLoaders.node=require("./documentLoaders/node"),e.documentLoaders.xhr=require("./documentLoaders/xhr"),e.useDocumentLoader=function(t){if(!(t in e.documentLoaders))throw new JsonLdError('Unknown document loader type: "'+t+'"',"jsonld.UnknownDocumentLoader",{type:t});e.documentLoader=e.documentLoaders[t].apply(e,Array.prototype.slice.call(arguments,1))};const t={};function n(t,{documentLoader:n=e.documentLoader,...o}){return Object.assign({},{documentLoader:n},o,t)}return e.registerRDFParser=function(e,n){t[e]=n},e.unregisterRDFParser=function(e){delete t[e]},e.registerRDFParser("application/n-quads",NQuads.parse),e.registerRDFParser("application/nquads",NQuads.parse),e.registerRDFParser("rdfa-api",Rdfa.parse),e.url=require("./url"),e.util=util,Object.assign(e,util),e.promises=e,e.RequestQueue=require("./RequestQueue"),e.JsonLdProcessor=require("./JsonLdProcessor")(e),_browser&&void 0===global.JsonLdProcessor&&Object.defineProperty(global,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:e.JsonLdProcessor}),_nodejs?e.useDocumentLoader("node"):"undefined"!=typeof XMLHttpRequest&&e.useDocumentLoader("xhr"),e},factory=function(){return wrapper(function(){return factory()})};wrapper(factory),module.exports=factory;

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./JsonLdError":3,"./JsonLdProcessor":4,"./NQuads":5,"./Rdfa":6,"./RequestQueue":7,"./compact":8,"./context":10,"./documentLoaders/node":11,"./documentLoaders/xhr":12,"./expand":13,"./flatten":14,"./frame":15,"./fromRdf":16,"./graphTypes":17,"./nodeMap":19,"./toRdf":20,"./types":21,"./url":22,"./util":23,"_process":30,"rdf-canonize":40}],19:[function(require,module,exports){
"use strict";const{isKeyword:isKeyword}=require("./context"),graphTypes=require("./graphTypes"),types=require("./types"),util=require("./util"),JsonLdError=require("./JsonLdError"),api={};module.exports=api,api.createMergedNodeMap=((e,t)=>{const r=(t=t||{}).issuer||new util.IdentifierIssuer("_:b"),i={"@default":{}};return api.createNodeMap(e,i,"@default",r),api.mergeNodeMaps(i)}),api.createNodeMap=((e,t,r,i,o,s)=>{if(types.isArray(e)){for(let o=0;o<e.length;++o)api.createNodeMap(e[o],t,r,i,void 0,s);return}if(!types.isObject(e))return void(s&&s.push(e));if(graphTypes.isValue(e)){if("@type"in e){let t=e["@type"];0===t.indexOf("_:")&&(e["@type"]=t=i.getId(t))}return void(s&&s.push(e))}if("@type"in e){const t=e["@type"];for(let e=0;e<t.length;++e){const r=t[e];0===r.indexOf("_:")&&i.getId(r)}}types.isUndefined(o)&&(o=graphTypes.isBlankNode(e)?i.getId(e["@id"]):e["@id"]),s&&s.push({"@id":o});const a=t[r],p=a[o]=a[o]||{};p["@id"]=o;const n=Object.keys(e).sort();for(let s=0;s<n.length;++s){let d=n[s];if("@id"===d)continue;if("@reverse"===d){const s={"@id":o},p=e["@reverse"];for(const e in p){const o=p[e];for(let p=0;p<o.length;++p){const n=o[p];let d=n["@id"];graphTypes.isBlankNode(n)&&(d=i.getId(d)),api.createNodeMap(n,t,r,i,d),util.addValue(a[d],e,s,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===d){o in t||(t[o]={}),api.createNodeMap(e[d],t,o,i);continue}if("@type"!==d&&isKeyword(d)){if("@index"===d&&d in p&&(e[d]!==p[d]||e[d]["@id"]!==p[d]["@id"]))throw new JsonLdError("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:p});p[d]=e[d];continue}const l=e[d];if(0===d.indexOf("_:")&&(d=i.getId(d)),0!==l.length)for(let e=0;e<l.length;++e){let s=l[e];if("@type"===d&&(s=0===s.indexOf("_:")?i.getId(s):s),graphTypes.isSubject(s)||graphTypes.isSubjectReference(s)){const e=graphTypes.isBlankNode(s)?i.getId(s["@id"]):s["@id"];util.addValue(p,d,{"@id":e},{propertyIsArray:!0,allowDuplicate:!1}),api.createNodeMap(s,t,r,i,e)}else if(graphTypes.isList(s)){const e=[];api.createNodeMap(s["@list"],t,r,i,o,e),s={"@list":e},util.addValue(p,d,s,{propertyIsArray:!0,allowDuplicate:!1})}else api.createNodeMap(s,t,r,i,o),util.addValue(p,d,s,{propertyIsArray:!0,allowDuplicate:!1})}else util.addValue(p,d,[],{propertyIsArray:!0})}}),api.mergeNodeMapGraphs=(e=>{const t={};for(const r of Object.keys(e).sort())for(const i of Object.keys(e[r]).sort()){const o=e[r][i];i in t||(t[i]={"@id":i});const s=t[i];for(const e of Object.keys(o).sort())if(isKeyword(e))s[e]=util.clone(o[e]);else for(const t of o[e])util.addValue(s,e,util.clone(t),{propertyIsArray:!0,allowDuplicate:!1})}return t}),api.mergeNodeMaps=(e=>{const t=e["@default"],r=Object.keys(e).sort();for(let i=0;i<r.length;++i){const o=r[i];if("@default"===o)continue;const s=e[o];let a=t[o];a?"@graph"in a||(a["@graph"]=[]):t[o]=a={"@id":o,"@graph":[]};const p=a["@graph"],n=Object.keys(s).sort();for(let e=0;e<n.length;++e){const t=s[n[e]];graphTypes.isSubjectReference(t)||p.push(t)}}return t});

},{"./JsonLdError":3,"./context":10,"./graphTypes":17,"./types":21,"./util":23}],20:[function(require,module,exports){
"use strict";const{createNodeMap:createNodeMap}=require("./nodeMap"),{isKeyword:isKeyword}=require("./context"),graphTypes=require("./graphTypes"),types=require("./types"),util=require("./util"),{RDF_FIRST:RDF_FIRST,RDF_REST:RDF_REST,RDF_NIL:RDF_NIL,RDF_TYPE:RDF_TYPE,RDF_LANGSTRING:RDF_LANGSTRING,XSD_BOOLEAN:XSD_BOOLEAN,XSD_DOUBLE:XSD_DOUBLE,XSD_INTEGER:XSD_INTEGER,XSD_STRING:XSD_STRING}=require("./constants"),{isAbsolute:_isAbsoluteIri}=require("./url"),api={};function _graphToRDF(e,t,a,o,s){const r=Object.keys(t).sort();for(let u=0;u<r.length;++u){const i=r[u],l=t[i],p=Object.keys(l).sort();for(let t of p){const r=l[t];if("@type"===t)t=RDF_TYPE;else if(isKeyword(t))continue;for(const u of r){const r={termType:i.startsWith("_:")?"BlankNode":"NamedNode",value:i};if(!_isAbsoluteIri(i))continue;const l={termType:t.startsWith("_:")?"BlankNode":"NamedNode",value:t};if(_isAbsoluteIri(t)&&("BlankNode"!==l.termType||s.produceGeneralizedRdf))if(graphTypes.isList(u))_listToRDF(u["@list"],o,r,l,e,a);else{const t=_objectToRDF(u);t&&e.push({subject:r,predicate:l,object:t,graph:a})}}}}}function _listToRDF(e,t,a,o,s,r){const u={termType:"NamedNode",value:RDF_FIRST},i={termType:"NamedNode",value:RDF_REST},l={termType:"NamedNode",value:RDF_NIL};for(const l of e){const e={termType:"BlankNode",value:t.getId()};s.push({subject:a,predicate:o,object:e,graph:r}),a=e,o=u;const p=_objectToRDF(l);p&&s.push({subject:a,predicate:o,object:p,graph:r}),o=i}s.push({subject:a,predicate:o,object:l,graph:r})}function _objectToRDF(e){const t={};if(graphTypes.isValue(e)){t.termType="Literal",t.value=void 0,t.datatype={termType:"NamedNode"};let a=e["@value"];const o=e["@type"]||null;types.isBoolean(a)?(t.value=a.toString(),t.datatype.value=o||XSD_BOOLEAN):types.isDouble(a)||o===XSD_DOUBLE?(types.isDouble(a)||(a=parseFloat(a)),t.value=a.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),t.datatype.value=o||XSD_DOUBLE):types.isNumber(a)?(t.value=a.toFixed(0),t.datatype.value=o||XSD_INTEGER):"@language"in e?(t.value=a,t.datatype.value=o||RDF_LANGSTRING,t.language=e["@language"]):(t.value=a,t.datatype.value=o||XSD_STRING)}else{const a=types.isObject(e)?e["@id"]:e;t.termType=a.startsWith("_:")?"BlankNode":"NamedNode",t.value=a}return"NamedNode"!==t.termType||_isAbsoluteIri(t.value)?t:null}module.exports=api,api.toRDF=((e,t)=>{const a=new util.IdentifierIssuer("_:b"),o={"@default":{}};createNodeMap(e,o,"@default",a);const s=[],r=Object.keys(o).sort();for(const e of r){let r;if("@default"===e)r={termType:"DefaultGraph",value:""};else{if(!_isAbsoluteIri(e))continue;(r=e.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"}).value=e}_graphToRDF(s,o[e],r,a,t)}return s});

},{"./constants":9,"./context":10,"./graphTypes":17,"./nodeMap":19,"./types":21,"./url":22,"./util":23}],21:[function(require,module,exports){
"use strict";const api={};module.exports=api,api.isArray=Array.isArray,api.isBoolean=(t=>"boolean"==typeof t||"[object Boolean]"===Object.prototype.toString.call(t)),api.isDouble=(t=>api.isNumber(t)&&-1!==String(t).indexOf(".")),api.isEmptyObject=(t=>api.isObject(t)&&0===Object.keys(t).length),api.isNumber=(t=>"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)),api.isNumeric=(t=>!isNaN(parseFloat(t))&&isFinite(t)),api.isObject=(t=>"[object Object]"===Object.prototype.toString.call(t)),api.isString=(t=>"string"==typeof t||"[object String]"===Object.prototype.toString.call(t)),api.isUndefined=(t=>void 0===t);

},{}],22:[function(require,module,exports){
"use strict";const types=require("./types"),api={};module.exports=api,api.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},api.parse=((e,t)=>{const r={},a=api.parsers[t||"full"],p=a.regex.exec(e);let s=a.keys.length;for(;s--;)r[a.keys[s]]=void 0===p[s]?null:p[s];return("https"===r.scheme&&"443"===r.port||"http"===r.scheme&&"80"===r.port)&&(r.href=r.href.replace(":"+r.port,""),r.authority=r.authority.replace(":"+r.port,""),r.port=null),r.normalizedPath=api.removeDotSegments(r.path),r}),api.prependBase=((e,t)=>{if(null===e)return t;if(-1!==t.indexOf(":"))return t;types.isString(e)&&(e=api.parse(e||""));const r=api.parse(t),a={protocol:e.protocol||""};if(null!==r.authority)a.authority=r.authority,a.path=r.path,a.query=r.query;else if(a.authority=e.authority,""===r.path)a.path=e.path,null!==r.query?a.query=r.query:a.query=e.query;else{if(0===r.path.indexOf("/"))a.path=r.path;else{let t=e.path;(t=t.substr(0,t.lastIndexOf("/")+1)).length>0&&"/"!==t.substr(-1)&&(t+="/"),t+=r.path,a.path=t}a.query=r.query}""!==r.path&&(a.path=api.removeDotSegments(a.path));let p=a.protocol;return null!==a.authority&&(p+="//"+a.authority),p+=a.path,null!==a.query&&(p+="?"+a.query),null!==r.fragment&&(p+="#"+r.fragment),""===p&&(p="./"),p}),api.removeBase=((e,t)=>{if(null===e)return t;types.isString(e)&&(e=api.parse(e||""));let r="";if(""!==e.href?r+=(e.protocol||"")+"//"+(e.authority||""):t.indexOf("//")&&(r+="//"),0!==t.indexOf(r))return t;const a=api.parse(t.substr(r.length)),p=e.normalizedPath.split("/"),s=a.normalizedPath.split("/"),i=a.fragment||a.query?0:1;for(;p.length>0&&s.length>i&&p[0]===s[0];)p.shift(),s.shift();let l="";if(p.length>0){p.pop();for(let e=0;e<p.length;++e)l+="../"}return l+=s.join("/"),null!==a.query&&(l+="?"+a.query),null!==a.fragment&&(l+="#"+a.fragment),""===l&&(l="./"),l}),api.removeDotSegments=(e=>{if(0===e.length)return"";const t=e.split("/"),r=[];for(;t.length>0;){const e=t.shift(),a=0===t.length;"."!==e?".."!==e?r.push(e):(r.pop(),a&&r.push("")):a&&r.push("")}return r.length>0&&""!==r[0]&&r.unshift(""),1===r.length&&""===r[0]?"/":r.join("/")});const isAbsoluteRegex=/^([A-Za-z][A-Za-z0-9+-.]*|_):/;api.isAbsolute=(e=>types.isString(e)&&isAbsoluteRegex.test(e)),api.isRelative=(e=>types.isString(e));

},{"./types":21}],23:[function(require,module,exports){
(function (process,setImmediate){
"use strict";const graphTypes=require("./graphTypes"),types=require("./types"),IdentifierIssuer=require("rdf-canonize").IdentifierIssuer,JsonLdError=require("./JsonLdError"),REGEX_LINK_HEADERS=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,REGEX_LINK_HEADER=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,REGEX_LINK_HEADER_PARAMS=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,DEFAULTS={headers:{accept:"application/ld+json, application/json"}},api={};module.exports=api,api.IdentifierIssuer=IdentifierIssuer;const _setImmediate="function"==typeof setImmediate&&setImmediate,_delay=_setImmediate?e=>_setImmediate(e):e=>setTimeout(e,0);function _invokeCallback(e,t,r){api.nextTick(()=>e(t,r))}function _labelBlankNodes(e,t){if(types.isArray(t))for(let r=0;r<t.length;++r)t[r]=_labelBlankNodes(e,t[r]);else if(graphTypes.isList(t))t["@list"]=_labelBlankNodes(e,t["@list"]);else if(types.isObject(t)){graphTypes.isBlankNode(t)&&(t["@id"]=e.getId(t["@id"]));const r=Object.keys(t).sort();for(let a=0;a<r.length;++a){const i=r[a];"@id"!==i&&(t[i]=_labelBlankNodes(e,t[i]))}}return t}"object"==typeof process&&"function"==typeof process.nextTick?api.nextTick=process.nextTick:api.nextTick=_delay,api.setImmediate=_setImmediate?_delay:api.nextTick,api.clone=function(e){if(e&&"object"==typeof e){let t;if(types.isArray(e)){t=[];for(let r=0;r<e.length;++r)t[r]=api.clone(e[r])}else if(e instanceof Map){t=new Map;for(const[r,a]of e)t.set(r,api.clone(a))}else if(e instanceof Set){t=new Set;for(const r of e)t.add(api.clone(r))}else if(types.isObject(e)){t={};for(const r in e)t[r]=api.clone(e[r])}else t=e.toString();return t}return e},api.asArray=function(e){return Array.isArray(e)?e:[e]},api.buildHeaders=((e={})=>{if(Object.keys(e).some(e=>"accept"===e.toLowerCase()))throw new RangeError('Accept header may not be specified; only "'+DEFAULTS.headers.accept+'" is supported.');return Object.assign({Accept:DEFAULTS.headers.accept},e)}),api.parseLinkHeader=(e=>{const t={},r=e.match(REGEX_LINK_HEADERS);for(let e=0;e<r.length;++e){let a=r[e].match(REGEX_LINK_HEADER);if(!a)continue;const i={target:a[1]},s=a[2];for(;a=REGEX_LINK_HEADER_PARAMS.exec(s);)i[a[1]]=void 0===a[2]?a[3]:a[2];const n=i.rel||"";Array.isArray(t[n])?t[n].push(i):t.hasOwnProperty(n)?t[n]=[t[n],i]:t[n]=i}return t}),api.validateTypeValue=(e=>{if(types.isString(e)||types.isEmptyObject(e))return;let t=!1;if(types.isArray(e)){t=!0;for(let r=0;r<e.length;++r)if(!types.isString(e[r])){t=!1;break}}if(!t)throw new JsonLdError('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, or an empty object.',"jsonld.SyntaxError",{code:"invalid type value",value:e})}),api.hasProperty=((e,t)=>{if(e.hasOwnProperty(t)){const r=e[t];return!types.isArray(r)||r.length>0}return!1}),api.hasValue=((e,t,r)=>{if(api.hasProperty(e,t)){let a=e[t];const i=graphTypes.isList(a);if(types.isArray(a)||i){i&&(a=a["@list"]);for(let e=0;e<a.length;++e)if(api.compareValues(r,a[e]))return!0}else if(!types.isArray(r))return api.compareValues(r,a)}return!1}),api.addValue=((e,t,r,a)=>{if("propertyIsArray"in(a=a||{})||(a.propertyIsArray=!1),"allowDuplicate"in a||(a.allowDuplicate=!0),types.isArray(r)){0===r.length&&a.propertyIsArray&&!e.hasOwnProperty(t)&&(e[t]=[]);for(let i=0;i<r.length;++i)api.addValue(e,t,r[i],a)}else if(e.hasOwnProperty(t)){const i=!a.allowDuplicate&&api.hasValue(e,t,r);types.isArray(e[t])||i&&!a.propertyIsArray||(e[t]=[e[t]]),i||e[t].push(r)}else e[t]=a.propertyIsArray?[r]:r}),api.getValues=((e,t)=>[].concat(e[t]||[])),api.removeProperty=((e,t)=>{delete e[t]}),api.removeValue=((e,t,r,a)=>{"propertyIsArray"in(a=a||{})||(a.propertyIsArray=!1);const i=api.getValues(e,t).filter(e=>!api.compareValues(e,r));0===i.length?api.removeProperty(e,t):1!==i.length||a.propertyIsArray?e[t]=i:e[t]=i[0]}),api.relabelBlankNodes=((e,t)=>{return _labelBlankNodes((t=t||{}).issuer||new IdentifierIssuer("_:b"),e)}),api.compareValues=((e,t)=>e===t||(!(!graphTypes.isValue(e)||!graphTypes.isValue(t)||e["@value"]!==t["@value"]||e["@type"]!==t["@type"]||e["@language"]!==t["@language"]||e["@index"]!==t["@index"])||!!(types.isObject(e)&&"@id"in e&&types.isObject(t)&&"@id"in t)&&e["@id"]===t["@id"])),api.compareShortestLeast=((e,t)=>e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1),api.normalizeDocumentLoader=(e=>e.length<2?api.callbackify(e):async function(t){const r=arguments[1];return new Promise((a,i)=>{try{e(t,(e,t)=>{if("function"==typeof r)return _invokeCallback(r,e,t);e?i(e):a(t)})}catch(e){if("function"==typeof r)return _invokeCallback(r,e);i(e)}})}),api.callbackify=(e=>(async function(...t){const r=t[t.length-1];let a;"function"==typeof r&&t.pop();try{a=await e.apply(null,t)}catch(e){if("function"==typeof r)return _invokeCallback(r,e);throw e}return"function"==typeof r?_invokeCallback(r,null,a):a}));

}).call(this,require('_process'),require("timers").setImmediate)
},{"./JsonLdError":3,"./graphTypes":17,"./types":21,"_process":30,"rdf-canonize":40,"timers":42}],24:[function(require,module,exports){
(function (Buffer){
var api={};module.exports=api;var _reverseAlphabets={};function _encodeWithByteBuffer(r,e){var t=0,n=e.length,o=e.charAt(0),a=[0];for(t=0;t<r.length();++t){for(var f=0,h=r.at(t);f<a.length;++f)h+=a[f]<<8,a[f]=h%n,h=h/n|0;for(;h>0;)a.push(h%n),h=h/n|0}var i="";for(t=0;0===r.at(t)&&t<r.length()-1;++t)i+=o;for(t=a.length-1;t>=0;--t)i+=e[a[t]];return i}api.encode=function(r,e,t){if("string"!=typeof e)throw new TypeError('"alphabet" must be a string.');if(void 0!==t&&"number"!=typeof t)throw new TypeError('"maxline" must be a number.');var n="";if(r instanceof Uint8Array){var o=0,a=e.length,f=e.charAt(0),h=[0];for(o=0;o<r.length;++o){for(var i=0,p=r[o];i<h.length;++i)p+=h[i]<<8,h[i]=p%a,p=p/a|0;for(;p>0;)h.push(p%a),p=p/a|0}for(o=0;0===r[o]&&o<r.length-1;++o)n+=f;for(o=h.length-1;o>=0;--o)n+=e[h[o]]}else n=_encodeWithByteBuffer(r,e);if(t){var s=new RegExp(".{1,"+t+"}","g");n=n.match(s).join("\r\n")}return n},api.decode=function(r,e){if("string"!=typeof r)throw new TypeError('"input" must be a string.');if("string"!=typeof e)throw new TypeError('"alphabet" must be a string.');var t=_reverseAlphabets[e];if(!t){t=_reverseAlphabets[e]=[];for(var n=0;n<e.length;++n)t[e.charCodeAt(n)]=n}r=r.replace(/\s/g,"");var o=e.length,a=e.charAt(0),f=[0];for(n=0;n<r.length;n++){var h=t[r.charCodeAt(n)];if(void 0===h)return;for(var i=0,p=h;i<f.length;++i)p+=f[i]*o,f[i]=255&p,p>>=8;for(;p>0;)f.push(255&p),p>>=8}for(var s=0;r[s]===a&&s<r.length-1;++s)f.push(0);return"undefined"!=typeof Buffer?Buffer.from(f.reverse()):new Uint8Array(f.reverse())};

}).call(this,require("buffer").Buffer)
},{"buffer":1}],25:[function(require,module,exports){
module.exports={options:{usePureJavaScript:!1}};

},{}],26:[function(require,module,exports){
var forge=require("./forge");module.exports=forge.md=forge.md||{},forge.md.algorithms=forge.md.algorithms||{};

},{"./forge":25}],27:[function(require,module,exports){
var forge=require("./forge");require("./md"),require("./util");var sha1=module.exports=forge.sha1=forge.sha1||{};forge.md.sha1=forge.md.algorithms.sha1=sha1,sha1.create=function(){_initialized||_init();var e=null,t=forge.util.createBuffer(),h=new Array(80),g={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){g.messageLength=0,g.fullMessageLength=g.messageLength64=[];for(var h=g.messageLengthSize/4,r=0;r<h;++r)g.fullMessageLength.push(0);return t=forge.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},g}};return g.start(),g.update=function(r,n){"utf8"===n&&(r=forge.util.encodeUtf8(r));var a=r.length;g.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var s=g.fullMessageLength.length-1;s>=0;--s)g.fullMessageLength[s]+=a[1],a[1]=a[0]+(g.fullMessageLength[s]/4294967296>>>0),g.fullMessageLength[s]=g.fullMessageLength[s]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(r),_update(e,h,t),(t.read>2048||0===t.length())&&t.compact(),g},g.digest=function(){var r=forge.util.createBuffer();r.putBytes(t.bytes());var n,a=g.fullMessageLength[g.fullMessageLength.length-1]+g.messageLengthSize&g.blockLength-1;r.putBytes(_padding.substr(0,g.blockLength-a));for(var s=8*g.fullMessageLength[0],u=0;u<g.fullMessageLength.length-1;++u)s+=(n=8*g.fullMessageLength[u+1])/4294967296>>>0,r.putInt32(s>>>0),s=n>>>0;r.putInt32(s);var l={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};_update(l,h,r);var f=forge.util.createBuffer();return f.putInt32(l.h0),f.putInt32(l.h1),f.putInt32(l.h2),f.putInt32(l.h3),f.putInt32(l.h4),f},g};var _padding=null,_initialized=!1;function _init(){_padding=String.fromCharCode(128),_padding+=forge.util.fillString(String.fromCharCode(0),64),_initialized=!0}function _update(e,t,h){for(var g,r,n,a,s,u,l,f=h.length();f>=64;){for(r=e.h0,n=e.h1,a=e.h2,s=e.h3,u=e.h4,l=0;l<16;++l)g=h.getInt32(),t[l]=g,g=(r<<5|r>>>27)+(s^n&(a^s))+u+1518500249+g,u=s,s=a,a=(n<<30|n>>>2)>>>0,n=r,r=g;for(;l<20;++l)g=(g=t[l-3]^t[l-8]^t[l-14]^t[l-16])<<1|g>>>31,t[l]=g,g=(r<<5|r>>>27)+(s^n&(a^s))+u+1518500249+g,u=s,s=a,a=(n<<30|n>>>2)>>>0,n=r,r=g;for(;l<32;++l)g=(g=t[l-3]^t[l-8]^t[l-14]^t[l-16])<<1|g>>>31,t[l]=g,g=(r<<5|r>>>27)+(n^a^s)+u+1859775393+g,u=s,s=a,a=(n<<30|n>>>2)>>>0,n=r,r=g;for(;l<40;++l)g=(g=t[l-6]^t[l-16]^t[l-28]^t[l-32])<<2|g>>>30,t[l]=g,g=(r<<5|r>>>27)+(n^a^s)+u+1859775393+g,u=s,s=a,a=(n<<30|n>>>2)>>>0,n=r,r=g;for(;l<60;++l)g=(g=t[l-6]^t[l-16]^t[l-28]^t[l-32])<<2|g>>>30,t[l]=g,g=(r<<5|r>>>27)+(n&a|s&(n^a))+u+2400959708+g,u=s,s=a,a=(n<<30|n>>>2)>>>0,n=r,r=g;for(;l<80;++l)g=(g=t[l-6]^t[l-16]^t[l-28]^t[l-32])<<2|g>>>30,t[l]=g,g=(r<<5|r>>>27)+(n^a^s)+u+3395469782+g,u=s,s=a,a=(n<<30|n>>>2)>>>0,n=r,r=g;e.h0=e.h0+r|0,e.h1=e.h1+n|0,e.h2=e.h2+a|0,e.h3=e.h3+s|0,e.h4=e.h4+u|0,f-=64}}

},{"./forge":25,"./md":26,"./util":29}],28:[function(require,module,exports){
var forge=require("./forge");require("./md"),require("./util");var sha256=module.exports=forge.sha256=forge.sha256||{};forge.md.sha256=forge.md.algorithms.sha256=sha256,sha256.create=function(){_initialized||_init();var e=null,t=forge.util.createBuffer(),h=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var h=n.messageLengthSize/4,g=0;g<h;++g)n.fullMessageLength.push(0);return t=forge.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n}};return n.start(),n.update=function(g,r){"utf8"===r&&(g=forge.util.encodeUtf8(g));var a=g.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var u=n.fullMessageLength.length-1;u>=0;--u)n.fullMessageLength[u]+=a[1],a[1]=a[0]+(n.fullMessageLength[u]/4294967296>>>0),n.fullMessageLength[u]=n.fullMessageLength[u]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(g),_update(e,h,t),(t.read>2048||0===t.length())&&t.compact(),n},n.digest=function(){var g=forge.util.createBuffer();g.putBytes(t.bytes());var r,a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize&n.blockLength-1;g.putBytes(_padding.substr(0,n.blockLength-a));for(var u=8*n.fullMessageLength[0],s=0;s<n.fullMessageLength.length-1;++s)u+=(r=8*n.fullMessageLength[s+1])/4294967296>>>0,g.putInt32(u>>>0),u=r>>>0;g.putInt32(u);var l={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};_update(l,h,g);var f=forge.util.createBuffer();return f.putInt32(l.h0),f.putInt32(l.h1),f.putInt32(l.h2),f.putInt32(l.h3),f.putInt32(l.h4),f.putInt32(l.h5),f.putInt32(l.h6),f.putInt32(l.h7),f},n};var _padding=null,_initialized=!1,_k=null;function _init(){_padding=String.fromCharCode(128),_padding+=forge.util.fillString(String.fromCharCode(0),64),_k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],_initialized=!0}function _update(e,t,h){for(var n,g,r,a,u,s,l,f,i,o,d,p,L,c=h.length();c>=64;){for(u=0;u<16;++u)t[u]=h.getInt32();for(;u<64;++u)n=((n=t[u-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,g=((g=t[u-15])>>>7|g<<25)^(g>>>18|g<<14)^g>>>3,t[u]=n+t[u-7]+g+t[u-16]|0;for(s=e.h0,l=e.h1,f=e.h2,i=e.h3,o=e.h4,d=e.h5,p=e.h6,L=e.h7,u=0;u<64;++u)r=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10),a=s&l|f&(s^l),n=L+((o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7))+(p^o&(d^p))+_k[u]+t[u],L=p,p=d,d=o,o=i+n>>>0,i=f,f=l,l=s,s=n+(g=r+a)>>>0;e.h0=e.h0+s|0,e.h1=e.h1+l|0,e.h2=e.h2+f|0,e.h3=e.h3+i|0,e.h4=e.h4+o|0,e.h5=e.h5+d|0,e.h6=e.h6+p|0,e.h7=e.h7+L|0,c-=64}}

},{"./forge":25,"./md":26,"./util":29}],29:[function(require,module,exports){
(function (process,global,Buffer,__argument0,__argument1,__argument2,__argument3,setImmediate){
var forge=require("./forge"),baseN=require("./baseN"),util=module.exports=forge.util=forge.util||{};function _checkBitsParam(t){if(8!==t&&16!==t&&24!==t&&32!==t)throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}function ByteStringBuffer(t){if(this.data="",this.read=0,"string"==typeof t)this.data=t;else if(util.isArrayBuffer(t)||util.isArrayBufferView(t))if("undefined"!=typeof Buffer&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch(t){for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof ByteStringBuffer||"object"==typeof t&&"string"==typeof t.data&&"number"==typeof t.read)&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}!function(){if("undefined"!=typeof process&&process.nextTick&&!process.browser)return util.nextTick=process.nextTick,void("function"==typeof setImmediate?util.setImmediate=setImmediate:util.setImmediate=util.nextTick);if("function"==typeof setImmediate)return util.setImmediate=function(){return setImmediate.apply(void 0,arguments)},void(util.nextTick=function(t){return setImmediate(t)});if(util.setImmediate=function(t){setTimeout(t,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var t="forge.setImmediate",e=[];util.setImmediate=function(r){e.push(r),1===e.length&&window.postMessage(t,"*")},window.addEventListener("message",function(r){if(r.source===window&&r.data===t){r.stopPropagation();var i=e.slice();e.length=0,i.forEach(function(t){t()})}},!0)}if("undefined"!=typeof MutationObserver){var r=Date.now(),i=!0,n=document.createElement("div");e=[];new MutationObserver(function(){var t=e.slice();e.length=0,t.forEach(function(t){t()})}).observe(n,{attributes:!0});var a=util.setImmediate;util.setImmediate=function(t){Date.now()-r>15?(r=Date.now(),a(t)):(e.push(t),1===e.length&&n.setAttribute("a",i=!i))}}util.nextTick=util.setImmediate}(),util.isNodejs="undefined"!=typeof process&&process.versions&&process.versions.node,util.globalScope=util.isNodejs||global?global:"undefined"==typeof self?window:self,util.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},util.isArrayBuffer=function(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer},util.isArrayBufferView=function(t){return t&&util.isArrayBuffer(t.buffer)&&void 0!==t.byteLength},util.ByteBuffer=ByteStringBuffer,util.ByteStringBuffer=ByteStringBuffer;var _MAX_CONSTRUCTED_STRING_LENGTH=4096;function DataBuffer(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=util.isArrayBuffer(t),i=util.isArrayBufferView(t);if(r||i)return this.data=r?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),void(this.write="writeOffset"in e?e.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!=t&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}util.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>_MAX_CONSTRUCTED_STRING_LENGTH&&(this.data.substr(0,1),this._constructedStringLength=0)},util.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},util.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},util.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))},util.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)1&e&&(r+=t),(e>>>=1)>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this},util.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this},util.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(util.encodeUtf8(t))},util.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(255&t))},util.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t))},util.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t))},util.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(255&t)+String.fromCharCode(t>>8&255))},util.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(255&t)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))},util.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(255&t)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))},util.ByteStringBuffer.prototype.putInt=function(t,e){_checkBitsParam(e);var r="";do{e-=8,r+=String.fromCharCode(t>>e&255)}while(e>0);return this.putBytes(r)},util.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)},util.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())},util.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},util.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t},util.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t},util.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t},util.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t},util.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t},util.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t},util.ByteStringBuffer.prototype.getInt=function(t){_checkBitsParam(t);var e=0;do{e=(e<<8)+this.data.charCodeAt(this.read++),t-=8}while(t>0);return e},util.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e},util.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):0===t?e="":(e=0===this.read?this.data:this.data.slice(this.read),this.clear()),e},util.ByteStringBuffer.prototype.bytes=function(t){return void 0===t?this.data.slice(this.read):this.data.slice(this.read,this.read+t)},util.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)},util.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this},util.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},util.ByteStringBuffer.prototype.copy=function(){var t=util.createBuffer(this.data);return t.read=this.read,t},util.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},util.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},util.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this},util.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t},util.ByteStringBuffer.prototype.toString=function(){return util.decodeUtf8(this.bytes())},util.DataBuffer=DataBuffer,util.DataBuffer.prototype.length=function(){return this.write-this.read},util.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},util.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),i=new Uint8Array(this.length()+e);return i.set(r),this.data=new DataView(i.buffer),this},util.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this},util.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this},util.DataBuffer.prototype.putBytes=function(t,e){if(util.isArrayBufferView(t)){var r=(i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)).byteLength-i.byteOffset;return this.accommodate(r),new Uint8Array(this.data.buffer,this.write).set(i),this.write+=r,this}if(util.isArrayBuffer(t)){var i=new Uint8Array(t);return this.accommodate(i.byteLength),new Uint8Array(this.data.buffer).set(i,this.write),this.write+=i.byteLength,this}if(t instanceof util.DataBuffer||"object"==typeof t&&"number"==typeof t.read&&"number"==typeof t.write&&util.isArrayBufferView(t.data)){i=new Uint8Array(t.data.byteLength,t.read,t.length());return this.accommodate(i.byteLength),new Uint8Array(t.data.byteLength,this.write).set(i),this.write+=i.byteLength,this}if(t instanceof util.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary","string"==typeof t){var n;if("hex"===e)return this.accommodate(Math.ceil(t.length/2)),n=new Uint8Array(this.data.buffer,this.write),this.write+=util.binary.hex.decode(t,n,this.write),this;if("base64"===e)return this.accommodate(3*Math.ceil(t.length/4)),n=new Uint8Array(this.data.buffer,this.write),this.write+=util.binary.base64.decode(t,n,this.write),this;if("utf8"===e&&(t=util.encodeUtf8(t),e="binary"),"binary"===e||"raw"===e)return this.accommodate(t.length),n=new Uint8Array(this.data.buffer,this.write),this.write+=util.binary.raw.decode(n),this;if("utf16"===e)return this.accommodate(2*t.length),n=new Uint16Array(this.data.buffer,this.write),this.write+=util.text.utf16.encode(n),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)},util.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this},util.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")},util.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this},util.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this},util.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this},util.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this},util.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this},util.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this},util.DataBuffer.prototype.putInt=function(t,e){_checkBitsParam(e),this.accommodate(e/8);do{e-=8,this.data.setInt8(this.write++,t>>e&255)}while(e>0);return this},util.DataBuffer.prototype.putSignedInt=function(t,e){return _checkBitsParam(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)},util.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},util.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t},util.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t},util.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t},util.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t},util.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t},util.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t},util.DataBuffer.prototype.getInt=function(t){_checkBitsParam(t);var e=0;do{e=(e<<8)+this.data.getInt8(this.read++),t-=8}while(t>0);return e},util.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e},util.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):0===t?e="":(e=0===this.read?this.data:this.data.slice(this.read),this.clear()),e},util.DataBuffer.prototype.bytes=function(t){return void 0===t?this.data.slice(this.read):this.data.slice(this.read,this.read+t)},util.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)},util.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this},util.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},util.DataBuffer.prototype.copy=function(){return new util.DataBuffer(this)},util.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this},util.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},util.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this},util.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t},util.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if("binary"===(t=t||"utf8")||"raw"===t)return util.binary.raw.encode(e);if("hex"===t)return util.binary.hex.encode(e);if("base64"===t)return util.binary.base64.encode(e);if("utf8"===t)return util.text.utf8.decode(e);if("utf16"===t)return util.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)},util.createBuffer=function(t,e){return e=e||"raw",void 0!==t&&"utf8"===e&&(t=util.encodeUtf8(t)),new util.ByteBuffer(t)},util.fillString=function(t,e){for(var r="";e>0;)1&e&&(r+=t),(e>>>=1)>0&&(t+=t);return r},util.xorBytes=function(t,e,r){for(var i="",n="",a="",u=0,o=0;r>0;--r,++u)n=t.charCodeAt(u)^e.charCodeAt(u),o>=10&&(i+=a,a="",o=0),a+=String.fromCharCode(n),++o;return i+=a},util.hexToBytes=function(t){var e="",r=0;for(!0&t.length&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e},util.bytesToHex=function(t){return util.createBuffer(t).toHex()},util.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(255&t)};var _base64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_base64Idx=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],_base58="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";util.encode64=function(t,e){for(var r,i,n,a="",u="",o=0;o<t.length;)r=t.charCodeAt(o++),i=t.charCodeAt(o++),n=t.charCodeAt(o++),a+=_base64.charAt(r>>2),a+=_base64.charAt((3&r)<<4|i>>4),isNaN(i)?a+="==":(a+=_base64.charAt((15&i)<<2|n>>6),a+=isNaN(n)?"=":_base64.charAt(63&n)),e&&a.length>e&&(u+=a.substr(0,e)+"\r\n",a=a.substr(e));return u+=a},util.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e,r,i,n,a="",u=0;u<t.length;)e=_base64Idx[t.charCodeAt(u++)-43],r=_base64Idx[t.charCodeAt(u++)-43],i=_base64Idx[t.charCodeAt(u++)-43],n=_base64Idx[t.charCodeAt(u++)-43],a+=String.fromCharCode(e<<2|r>>4),64!==i&&(a+=String.fromCharCode((15&r)<<4|i>>2),64!==n&&(a+=String.fromCharCode((3&i)<<6|n)));return a},util.encodeUtf8=function(t){return unescape(encodeURIComponent(t))},util.decodeUtf8=function(t){return decodeURIComponent(escape(t))},util.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:baseN.encode,decode:baseN.decode}},util.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)},util.binary.raw.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(t.length));for(var n=r=r||0,a=0;a<t.length;++a)i[n++]=t.charCodeAt(a);return e?n-r:i},util.binary.hex.encode=util.bytesToHex,util.binary.hex.decode=function(t,e,r){var i=e;i||(i=new Uint8Array(Math.ceil(t.length/2)));var n=0,a=r=r||0;for(1&t.length&&(n=1,i[a++]=parseInt(t[0],16));n<t.length;n+=2)i[a++]=parseInt(t.substr(n,2),16);return e?a-r:i},util.binary.base64.encode=function(t,e){for(var r,i,n,a="",u="",o=0;o<t.byteLength;)r=t[o++],i=t[o++],n=t[o++],a+=_base64.charAt(r>>2),a+=_base64.charAt((3&r)<<4|i>>4),isNaN(i)?a+="==":(a+=_base64.charAt((15&i)<<2|n>>6),a+=isNaN(n)?"=":_base64.charAt(63&n)),e&&a.length>e&&(u+=a.substr(0,e)+"\r\n",a=a.substr(e));return u+=a},util.binary.base64.decode=function(t,e,r){var i,n,a,u,o=e;o||(o=new Uint8Array(3*Math.ceil(t.length/4))),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var s=0,f=r=r||0;s<t.length;)i=_base64Idx[t.charCodeAt(s++)-43],n=_base64Idx[t.charCodeAt(s++)-43],a=_base64Idx[t.charCodeAt(s++)-43],u=_base64Idx[t.charCodeAt(s++)-43],o[f++]=i<<2|n>>4,64!==a&&(o[f++]=(15&n)<<4|a>>2,64!==u&&(o[f++]=(3&a)<<6|u));return e?f-r:o.subarray(0,f)},util.binary.base58.encode=function(t,e){return util.binary.baseN.encode(t,_base58,e)},util.binary.base58.decode=function(t,e){return util.binary.baseN.decode(t,_base58,e)},util.text={utf8:{},utf16:{}},util.text.utf8.encode=function(t,e,r){t=util.encodeUtf8(t);var i=e;i||(i=new Uint8Array(t.length));for(var n=r=r||0,a=0;a<t.length;++a)i[n++]=t.charCodeAt(a);return e?n-r:i},util.text.utf8.decode=function(t){return util.decodeUtf8(String.fromCharCode.apply(null,t))},util.text.utf16.encode=function(t,e,r){var i=e;i||(i=new Uint8Array(2*t.length));for(var n=new Uint16Array(i.buffer),a=r=r||0,u=r,o=0;o<t.length;++o)n[u++]=t.charCodeAt(o),a+=2;return e?a-r:i},util.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))},util.deflate=function(t,e,r){if(e=util.decode64(t.deflate(util.encode64(e)).rval),r){var i=2;32&e.charCodeAt(1)&&(i=6),e=e.substring(i,e.length-4)}return e},util.inflate=function(t,e,r){var i=t.inflate(util.encode64(e)).rval;return null===i?null:util.decode64(i)};var _setStorageObject=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var i;if(null===r?i=t.removeItem(e):(r=util.encode64(JSON.stringify(r)),i=t.setItem(e,r)),void 0!==i&&!0!==i.rval){var n=new Error(i.error.message);throw n.id=i.error.id,n.name=i.error.name,n}},_getStorageObject=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(null===r.rval){if(r.error){var i=new Error(r.error.message);throw i.id=r.error.id,i.name=r.error.name,i}r=null}else r=r.rval;return null!==r&&(r=JSON.parse(util.decode64(r))),r},_setItem=function(t,e,r,i){var n=_getStorageObject(t,e);null===n&&(n={}),n[r]=i,_setStorageObject(t,e,n)},_getItem=function(t,e,r){var i=_getStorageObject(t,e);return null!==i&&(i=r in i?i[r]:null),i},_removeItem=function(t,e,r){var i=_getStorageObject(t,e);if(null!==i&&r in i){delete i[r];var n=!0;for(var a in i){n=!1;break}n&&(i=null),_setStorageObject(t,e,i)}},_clearItems=function(t,e){_setStorageObject(t,e,null)},_callStorageFunction=function(t,e,r){var i,n=null;void 0===r&&(r=["web","flash"]);var a=!1,u=null;for(var o in r){i=r[o];try{if("flash"===i||"both"===i){if(null===e[0])throw new Error("Flash local storage not available.");n=t.apply(this,e),a="flash"===i}"web"!==i&&"both"!==i||(e[0]=localStorage,n=t.apply(this,e),a=!0)}catch(t){u=t}if(a)break}if(!a)throw u;return n};util.setItem=function(t,e,r,i,n){_callStorageFunction(_setItem,arguments,n)},util.getItem=function(t,e,r,i){return _callStorageFunction(_getItem,arguments,i)},util.removeItem=function(t,e,r,i){_callStorageFunction(_removeItem,arguments,i)},util.clearItems=function(t,e,r){_callStorageFunction(_clearItems,arguments,r)},util.parseUrl=function(t){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;e.lastIndex=0;var r=e.exec(t),i=null===r?null:{full:t,scheme:r[1],host:r[2],port:r[3],path:r[4]};return i&&(i.fullHost=i.host,i.port?80!==i.port&&"http"===i.scheme?i.fullHost+=":"+i.port:443!==i.port&&"https"===i.scheme&&(i.fullHost+=":"+i.port):"http"===i.scheme?i.port=80:"https"===i.scheme&&(i.port=443),i.full=i.scheme+"://"+i.fullHost),i};var _queryVariables=null;util.getQueryVariables=function(t){var e,r=function(t){for(var e={},r=t.split("&"),i=0;i<r.length;i++){var n,a,u=r[i].indexOf("=");u>0?(n=r[i].substring(0,u),a=r[i].substring(u+1)):(n=r[i],a=null),n in e||(e[n]=[]),n in Object.prototype||null===a||e[n].push(unescape(a))}return e};return void 0===t?(null===_queryVariables&&(_queryVariables="undefined"!=typeof window&&window.location&&window.location.search?r(window.location.search.substring(1)):{}),e=_queryVariables):e=r(t),e},util.parseFragment=function(t){var e=t,r="",i=t.indexOf("?");i>0&&(e=t.substring(0,i),r=t.substring(i+1));var n=e.split("/");return n.length>0&&""===n[0]&&n.shift(),{pathString:e,queryString:r,path:n,query:""===r?{}:util.getQueryVariables(r)}},util.makeRequest=function(t){var e=util.parseFragment(t),r={path:e.pathString,query:e.queryString,getPath:function(t){return void 0===t?e.path:e.path[t]},getQuery:function(t,r){var i;return void 0===t?i=e.query:(i=e.query[t])&&void 0!==r&&(i=i[r]),i},getQueryLast:function(t,e){var i=r.getQuery(t);return i?i[i.length-1]:e}};return r},util.makeLink=function(t,e,r){t=jQuery.isArray(t)?t.join("/"):t;var i=jQuery.param(e||{});return r=r||"",t+(i.length>0?"?"+i:"")+(r.length>0?"#"+r:"")},util.setPath=function(t,e,r){if("object"==typeof t&&null!==t)for(var i=0,n=e.length;i<n;){var a=e[i++];if(i==n)t[a]=r;else{var u=a in t;(!u||u&&"object"!=typeof t[a]||u&&null===t[a])&&(t[a]={}),t=t[a]}}},util.getPath=function(t,e,r){for(var i=0,n=e.length,a=!0;a&&i<n&&"object"==typeof t&&null!==t;){var u=e[i++];(a=u in t)&&(t=t[u])}return a?t:r},util.deletePath=function(t,e){if("object"==typeof t&&null!==t)for(var r=0,i=e.length;r<i;){var n=e[r++];if(r==i)delete t[n];else{if(!(n in t)||"object"!=typeof t[n]||null===t[n])break;t=t[n]}}},util.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},util.format=function(t){for(var e,r,i=/%./g,n=0,a=[],u=0;e=i.exec(t);){(r=t.substring(u,i.lastIndex-2)).length>0&&a.push(r),u=i.lastIndex;var o=e[0][1];switch(o){case"s":case"o":n<arguments.length?a.push(arguments[1+n++]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+o+"?>")}}return a.push(t.substring(u)),a.join("")},util.formatNumber=function(t,e,r,i){var n=t,a=isNaN(e=Math.abs(e))?2:e,u=void 0===r?",":r,o=void 0===i?".":i,s=n<0?"-":"",f=parseInt(n=Math.abs(+n||0).toFixed(a),10)+"",h=f.length>3?f.length%3:0;return s+(h?f.substr(0,h)+o:"")+f.substr(h).replace(/(\d{3})(?=\d)/g,"$1"+o)+(a?u+Math.abs(n-f).toFixed(a).slice(2):"")},util.formatSize=function(t){return t=t>=1073741824?util.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?util.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?util.formatNumber(t/1024,0)+" KiB":util.formatNumber(t,0)+" bytes"},util.bytesFromIP=function(t){return-1!==t.indexOf(".")?util.bytesFromIPv4(t):-1!==t.indexOf(":")?util.bytesFromIPv6(t):null},util.bytesFromIPv4=function(t){if(4!==(t=t.split(".")).length)return null;for(var e=util.createBuffer(),r=0;r<t.length;++r){var i=parseInt(t[r],10);if(isNaN(i))return null;e.putByte(i)}return e.getBytes()},util.bytesFromIPv6=function(t){for(var e=0,r=2*(8-(t=t.split(":").filter(function(t){return 0===t.length&&++e,!0})).length+e),i=util.createBuffer(),n=0;n<8;++n)if(t[n]&&0!==t[n].length){var a=util.hexToBytes(t[n]);a.length<2&&i.putByte(0),i.putBytes(a)}else i.fillWithByte(0,r),r=0;return i.getBytes()},util.bytesToIP=function(t){return 4===t.length?util.bytesToIPv4(t):16===t.length?util.bytesToIPv6(t):null},util.bytesToIPv4=function(t){if(4!==t.length)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")},util.bytesToIPv6=function(t){if(16!==t.length)return null;for(var e=[],r=[],i=0,n=0;n<t.length;n+=2){for(var a=util.bytesToHex(t[n]+t[n+1]);"0"===a[0]&&"0"!==a;)a=a.substr(1);if("0"===a){var u=r[r.length-1],o=e.length;u&&o===u.end+1?(u.end=o,u.end-u.start>r[i].end-r[i].start&&(i=r.length-1)):r.push({start:o,end:o})}e.push(a)}if(r.length>0){var s=r[i];s.end-s.start>0&&(e.splice(s.start,s.end-s.start+1,""),0===s.start&&e.unshift(""),7===s.end&&e.push(""))}return e.join(":")},util.estimateCores=function(t,e){if("function"==typeof t&&(e=t,t={}),t=t||{},"cores"in util&&!t.update)return e(null,util.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return util.cores=navigator.hardwareConcurrency,e(null,util.cores);if("undefined"==typeof Worker)return util.cores=1,e(null,util.cores);if("undefined"==typeof Blob)return util.cores=2,e(null,util.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(t){for(var e=Date.now(),r=e+4;Date.now()<r;);self.postMessage({st:e,et:r})})}.toString(),")()"],{type:"application/javascript"}));!function t(i,n,a){if(0===n){var u=Math.floor(i.reduce(function(t,e){return t+e},0)/i.length);return util.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,util.cores)}!function(t,e){for(var i=[],n=[],a=0;a<t;++a){var u=new Worker(r);u.addEventListener("message",function(r){if(n.push(r.data),n.length===t){for(var a=0;a<t;++a)i[a].terminate();e(null,n)}}),i.push(u)}for(var a=0;a<t;++a)i[a].postMessage(a)}(a,function(e,r){i.push(function(t,e){for(var r=[],i=0;i<t;++i)for(var n=e[i],a=r[i]=[],u=0;u<t;++u)if(i!==u){var o=e[u];(n.st>o.st&&n.st<o.et||o.st>n.st&&o.st<n.et)&&a.push(u)}return r.reduce(function(t,e){return Math.max(t,e.length)},0)}(a,r)),t(i,n-1,a)})}([],5,16)};

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],require("timers").setImmediate)
},{"./baseN":24,"./forge":25,"_process":30,"buffer":1,"timers":42}],30:[function(require,module,exports){
var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}process.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(e){return[]},process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};

},{}],31:[function(require,module,exports){
"use strict";const util=require("./util");module.exports=class{constructor({maxCallStackDepth:t=500,maxTotalCallStackDepth:e=4294967295,timeSlice:i=10}={}){this.schedule={},this.schedule.MAX_DEPTH=t,this.schedule.MAX_TOTAL_DEPTH=e,this.schedule.depth=0,this.schedule.totalDepth=0,this.schedule.timeSlice=i}doWork(t,e){const i=this.schedule;if(i.totalDepth>=i.MAX_TOTAL_DEPTH)return e(new Error("Maximum total call stack depth exceeded; canonicalization aborting."));!function n(){if(i.depth===i.MAX_DEPTH)return i.depth=0,i.running=!1,util.nextTick(n);const l=Date.now();if(i.running||(i.start=Date.now(),i.deadline=i.start+i.timeSlice),l<i.deadline)return i.running=!0,i.depth++,i.totalDepth++,t((t,n)=>{i.depth--,i.totalDepth--,e(t,n)});i.depth=0,i.running=!1,util.setImmediate(n)}()}forEach(t,e,i){const n=this;let l,o,s=0;if(Array.isArray(t))o=t.length,l=(()=>s!==o&&(l.value=t[s++],l.key=s,!0));else{const e=Object.keys(t);o=e.length,l=(()=>s!==o&&(l.key=e[s++],l.value=t[l.key],!0))}!function t(o){return o?i(o):l()?n.doWork(()=>e(l.value,l.key,t)):void i()}()}waterfall(t,e){const i=this;i.forEach(t,(t,e,n)=>i.doWork(t,n),e)}whilst(t,e,i){const n=this;!function l(o){return o?i(o):t()?void n.doWork(e,l):i()}()}};

},{"./util":41}],32:[function(require,module,exports){
"use strict";const util=require("./util");module.exports=class t{constructor(t){this.prefix=t,this.counter=0,this.existing={}}clone(){const i=new t(this.prefix);return i.counter=this.counter,i.existing=util.clone(this.existing),i}getId(t){if(t&&t in this.existing)return this.existing[t];const i=this.prefix+this.counter;return this.counter+=1,t&&(this.existing[t]=i),i}hasId(t){return t in this.existing}};

},{"./util":41}],33:[function(require,module,exports){
"use strict";const forge=require("node-forge/lib/forge");require("node-forge/lib/md"),require("node-forge/lib/sha1"),require("node-forge/lib/sha256"),module.exports=class{constructor(e){this.md=forge.md[e].create()}update(e){this.md.update(e,"utf8")}digest(){return this.md.digest().toHex()}};

},{"node-forge/lib/forge":25,"node-forge/lib/md":26,"node-forge/lib/sha1":27,"node-forge/lib/sha256":28}],34:[function(require,module,exports){
"use strict";const TERMS=["subject","predicate","object","graph"],RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDF_LANGSTRING=RDF+"langString",XSD_STRING="http://www.w3.org/2001/XMLSchema#string",REGEX={};function _compareTriples(e,a){for(const t in e)if(e[t].termType!==a[t].termType||e[t].value!==a[t].value)return!1;return"Literal"!==e.object.termType||e.object.datatype.termType===a.object.datatype.termType&&e.object.datatype.value===a.object.datatype.value&&e.object.language===a.object.language}REGEX.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,REGEX.empty=new RegExp("^[ \\t]*$"),REGEX.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z-----------_0-9])(?:(?:[A-Za-z-----------_0-9---.])*(?:[A-Za-z-----------_0-9---]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z-----------_0-9])(?:(?:[A-Za-z-----------_0-9---.])*(?:[A-Za-z-----------_0-9---]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z-----------_0-9])(?:(?:[A-Za-z-----------_0-9---.])*(?:[A-Za-z-----------_0-9---]))?))[ \\t]*\\.))[ \\t]*$'),module.exports=class e{static parse(e){const a=[],t={},r=e.split(REGEX.eoln);let n=0;for(const e of r){if(n++,REGEX.empty.test(e))continue;const r=e.match(REGEX.quad);if(null===r)throw new Error("N-Quads parse error on line "+n+".");const o={};if(void 0!==r[1]?o.subject={termType:"NamedNode",value:r[1]}:o.subject={termType:"BlankNode",value:r[2]},o.predicate={termType:"NamedNode",value:r[3]},void 0!==r[4]?o.object={termType:"NamedNode",value:r[4]}:void 0!==r[5]?o.object={termType:"BlankNode",value:r[5]}:(o.object={termType:"Literal",value:void 0,datatype:{termType:"NamedNode"}},void 0!==r[7]?o.object.datatype.value=r[7]:void 0!==r[8]?(o.object.datatype.value=RDF_LANGSTRING,o.object.language=r[8]):o.object.datatype.value=XSD_STRING,o.object.value=_unescape(r[6])),void 0!==r[9]?o.graph={termType:"NamedNode",value:r[9]}:void 0!==r[10]?o.graph={termType:"BlankNode",value:r[10]}:o.graph={termType:"DefaultGraph",value:""},o.graph.value in t){let e=!0;const r=t[o.graph.value];for(const a of r)if(_compareTriples(a,o)){e=!1;break}e&&(r.push(o),a.push(o))}else t[o.graph.value]=[o],a.push(o)}return a}static serialize(a){Array.isArray(a)||(a=e.legacyDatasetToQuads(a));const t=[];for(const r of a)t.push(e.serializeQuad(r));return t.sort().join("")}static serializeQuad(e){const a=e.subject,t=e.predicate,r=e.object,n=e.graph;let o="";return[a,t].forEach(e=>{"NamedNode"===e.termType?o+="<"+e.value+">":o+=e.value,o+=" "}),"NamedNode"===r.termType?o+="<"+r.value+">":"BlankNode"===r.termType?o+=r.value:(o+='"'+_escape(r.value)+'"',r.datatype.value===RDF_LANGSTRING?r.language&&(o+="@"+r.language):r.datatype.value!==XSD_STRING&&(o+="^^<"+r.datatype.value+">")),"NamedNode"===n.termType?o+=" <"+n.value+">":"BlankNode"===n.termType&&(o+=" "+n.value),o+=" .\n"}static legacyDatasetToQuads(e){const a=[],t={"blank node":"BlankNode",IRI:"NamedNode",literal:"Literal"};for(const r in e){e[r].forEach(e=>{const n={};for(const a in e){const r=e[a],o={termType:t[r.type],value:r.value};"Literal"===o.termType&&(o.datatype={termType:"NamedNode"},"datatype"in r&&(o.datatype.value=r.datatype),"language"in r?("datatype"in r||(o.datatype.value=RDF_LANGSTRING),o.language=r.language):"datatype"in r||(o.datatype.value=XSD_STRING)),n[a]=o}n.graph="@default"===r?{termType:"DefaultGraph",value:""}:{termType:r.startsWith("_:")?"BlankNode":"NamedNode",value:r},a.push(n)})}return a}};const _escapeRegex=/["\\\n\r]/g;function _escape(e){return e.replace(_escapeRegex,function(e){switch(e){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}})}const _unescapeRegex=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g;function _unescape(e){return e.replace(_unescapeRegex,function(e,a,t,r){if(a)switch(a){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(t)return String.fromCharCode(parseInt(t,16));if(r)throw new Error("Unsupported U escape")})}

},{}],35:[function(require,module,exports){
"use strict";module.exports=class{constructor(t){this.list=t.sort(),this.done=!1,this.left={};for(let s=0;s<t.length;++s)this.left[t[s]]=!0}hasNext(){return!this.done}next(){const t=this.list.slice();let s=null,i=0;const l=this.list.length;for(let t=0;t<l;++t){const e=this.list[t],h=this.left[e];(null===s||e>s)&&(h&&t>0&&e>this.list[t-1]||!h&&t<l-1&&e>this.list[t+1])&&(s=e,i=t)}if(null===s)this.done=!0;else{const t=this.left[s]?i-1:i+1;this.list[i]=this.list[t],this.list[t]=s;for(let t=0;t<l;++t)this.list[t]>s&&(this.left[this.list[t]]=!this.left[this.list[t]])}return t}};

},{}],36:[function(require,module,exports){
"use strict";const AsyncAlgorithm=require("./AsyncAlgorithm"),IdentifierIssuer=require("./IdentifierIssuer"),MessageDigest=require("./MessageDigest"),Permutator=require("./Permutator"),NQuads=require("./NQuads"),util=require("./util"),POSITIONS={subject:"s",object:"o",graph:"g"};module.exports=class extends AsyncAlgorithm{constructor(e){super(e=e||{}),this.name="URDNA2015",this.options=Object.assign({},e),this.blankNodeInfo={},this.hashToBlankNodes={},this.canonicalIssuer=new IdentifierIssuer("_:c14n"),this.hashAlgorithm="sha256",this.quads}main(e,s){const t=this;let a;t.schedule.start=Date.now(),t.quads=e;const r={};t.waterfall([s=>{t.forEach(e,(e,s,a)=>{t.forEachComponent(e,s=>{if("BlankNode"!==s.termType)return;const a=s.value;a in t.blankNodeInfo?t.blankNodeInfo[a].quads.push(e):(r[a]=!0,t.blankNodeInfo[a]={quads:[e]})}),a()},s)},e=>{let s=!0;t.whilst(()=>s,e=>{s=!1,t.hashToBlankNodes={},t.waterfall([e=>{t.forEach(r,(e,s,a)=>{t.hashFirstDegreeQuads(s,(e,r)=>{if(e)return a(e);r in t.hashToBlankNodes?t.hashToBlankNodes[r].push(s):t.hashToBlankNodes[r]=[s],a()})},e)},e=>{const a=Object.keys(t.hashToBlankNodes).sort();t.forEach(a,(e,a,n)=>{const o=t.hashToBlankNodes[e];if(o.length>1)return n();const h=o[0];t.canonicalIssuer.getId(h),delete r[h],delete t.hashToBlankNodes[e],s=!0,n()},e)}],e)},e)},e=>{const s=Object.keys(t.hashToBlankNodes).sort();t.forEach(s,(e,s,a)=>{const r=[],n=t.hashToBlankNodes[e];t.waterfall([e=>{t.forEach(n,(e,s,a)=>{if(t.canonicalIssuer.hasId(e))return a();const n=new IdentifierIssuer("_:b");n.getId(e),t.hashNDegreeQuads(e,n,(e,s)=>{if(e)return a(e);r.push(s),a()})},e)},e=>{r.sort((e,s)=>e.hash<s.hash?-1:e.hash>s.hash?1:0),t.forEach(r,(e,s,a)=>{for(const s in e.issuer.existing)t.canonicalIssuer.getId(s);a()},e)}],a)},e)},e=>{const s=[];t.waterfall([e=>{t.forEach(t.quads,(e,a,r)=>{t.forEachComponent(e,e=>{"BlankNode"!==e.termType||e.value.startsWith(t.canonicalIssuer.prefix)||(e.value=t.canonicalIssuer.getId(e.value))}),s.push(NQuads.serializeQuad(e)),r()},e)},e=>(s.sort(),a=s.join(""),e())],e)}],e=>s(e,a))}hashFirstDegreeQuads(e,s){const t=this,a=t.blankNodeInfo[e];if("hash"in a)return s(null,a.hash);const r=[],n=a.quads;t.forEach(n,(s,a,n)=>{const o={predicate:s.predicate};t.forEachComponent(s,(s,a)=>{o[a]=t.modifyFirstDegreeComponent(e,s,a)}),r.push(NQuads.serializeQuad(o)),n()},e=>{if(e)return s(e);r.sort();const n=new MessageDigest(t.hashAlgorithm);for(let e=0;e<r.length;++e)n.update(r[e]);a.hash=n.digest(),s(null,a.hash)})}hashRelatedBlankNode(e,s,t,a,r){const n=this;let o;n.waterfall([s=>n.canonicalIssuer.hasId(e)?(o=n.canonicalIssuer.getId(e),s()):t.hasId(e)?(o=t.getId(e),s()):void n.hashFirstDegreeQuads(e,(e,t)=>{if(e)return s(e);o=t,s()})],e=>{if(e)return r(e);const t=new MessageDigest(n.hashAlgorithm);return t.update(a),"g"!==a&&t.update(n.getRelatedPredicate(s)),t.update(o),r(null,t.digest())})}hashNDegreeQuads(e,s,t){const a=this;let r;const n=new MessageDigest(a.hashAlgorithm);a.waterfall([t=>a.createHashToRelated(e,s,(e,s)=>{if(e)return t(e);r=s,t()}),e=>{const t=Object.keys(r).sort();a.forEach(t,(e,t,o)=>{n.update(e);let h,i="";const l=new Permutator(r[e]);a.whilst(()=>l.hasNext(),e=>{const t=l.next();let r=s.clone(),n="";const o=[];a.waterfall([s=>{a.forEach(t,(s,t,h)=>{if(a.canonicalIssuer.hasId(s)?n+=a.canonicalIssuer.getId(s):(r.hasId(s)||o.push(s),n+=r.getId(s)),0!==i.length&&n.length>=i.length&&n>i)return e();h()},s)},s=>{a.forEach(o,(s,t,o)=>{a.hashNDegreeQuads(s,r,(t,a)=>t?o(t):(n+=r.getId(s),n+="<"+a.hash+">",r=a.issuer,0!==i.length&&n.length>=i.length&&n>i?e():void o()))},s)},e=>{(0===i.length||n<i)&&(i=n,h=r),e()}],e)},e=>{if(e)return o(e);n.update(i),s=h,o()})},e)}],e=>{t(e,{hash:n.digest(),issuer:s})})}modifyFirstDegreeComponent(e,s){return"BlankNode"!==s.termType?s:((s=util.clone(s)).value=s.value===e?"_:a":"_:z",s)}getRelatedPredicate(e){return"<"+e.predicate.value+">"}createHashToRelated(e,s,t){const a=this,r={},n=a.blankNodeInfo[e].quads;a.forEach(n,(t,n,o)=>{a.forEach(t,(n,o,h)=>{if("predicate"===o||"BlankNode"!==n.termType||n.value===e)return h();const i=n.value,l=POSITIONS[o];a.hashRelatedBlankNode(i,t,s,l,(e,s)=>{if(e)return h(e);s in r?r[s].push(i):r[s]=[i],h()})},o)},e=>t(e,r))}forEachComponent(e,s){for(const t in e)"predicate"!==t&&s(e[t],t,e)}};

},{"./AsyncAlgorithm":31,"./IdentifierIssuer":32,"./MessageDigest":33,"./NQuads":34,"./Permutator":35,"./util":41}],37:[function(require,module,exports){
"use strict";const IdentifierIssuer=require("./IdentifierIssuer"),MessageDigest=require("./MessageDigest"),Permutator=require("./Permutator"),NQuads=require("./NQuads"),util=require("./util"),POSITIONS={subject:"s",object:"o",graph:"g"};module.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo={},this.hashToBlankNodes={},this.canonicalIssuer=new IdentifierIssuer("_:c14n"),this.hashAlgorithm="sha256",this.quads}main(e){const s=this;s.quads=e;const t={};for(const n of e)s.forEachComponent(n,e=>{if("BlankNode"!==e.termType)return;const a=e.value;a in s.blankNodeInfo?s.blankNodeInfo[a].quads.push(n):(t[a]=!0,s.blankNodeInfo[a]={quads:[n]})});let n=!0;for(;n;){n=!1,s.hashToBlankNodes={};for(const e in t){const t=s.hashFirstDegreeQuads(e);t in s.hashToBlankNodes?s.hashToBlankNodes[t].push(e):s.hashToBlankNodes[t]=[e]}const e=Object.keys(s.hashToBlankNodes).sort();for(let a=0;a<e.length;++a){const o=e[a],r=s.hashToBlankNodes[o];if(r.length>1)continue;const h=r[0];s.canonicalIssuer.getId(h),delete t[h],delete s.hashToBlankNodes[o],n=!0}}const a=Object.keys(s.hashToBlankNodes).sort();for(let e=0;e<a.length;++e){const t=[],n=a[e],o=s.hashToBlankNodes[n];for(let e=0;e<o.length;++e){const n=o[e];if(s.canonicalIssuer.hasId(n))continue;const a=new IdentifierIssuer("_:b");a.getId(n);const r=s.hashNDegreeQuads(n,a);t.push(r)}t.sort((e,s)=>e.hash<s.hash?-1:e.hash>s.hash?1:0);for(let e=0;e<t.length;++e){const n=t[e];for(const e in n.issuer.existing)s.canonicalIssuer.getId(e)}}const o=[];for(let e=0;e<s.quads.length;++e){const t=s.quads[e];s.forEachComponent(t,e=>{"BlankNode"!==e.termType||e.value.startsWith(s.canonicalIssuer.prefix)||(e.value=s.canonicalIssuer.getId(e.value))}),o.push(NQuads.serializeQuad(t))}return o.sort(),o.join("")}hashFirstDegreeQuads(e){const s=this,t=s.blankNodeInfo[e];if("hash"in t)return t.hash;const n=[],a=t.quads;for(let t=0;t<a.length;++t){const o=a[t],r={predicate:o.predicate};s.forEachComponent(o,(t,n)=>{r[n]=s.modifyFirstDegreeComponent(e,t,n)}),n.push(NQuads.serializeQuad(r))}n.sort();const o=new MessageDigest(s.hashAlgorithm);for(let e=0;e<n.length;++e)o.update(n[e]);return t.hash=o.digest(),t.hash}hashRelatedBlankNode(e,s,t,n){const a=this;let o;o=a.canonicalIssuer.hasId(e)?a.canonicalIssuer.getId(e):t.hasId(e)?t.getId(e):a.hashFirstDegreeQuads(e);const r=new MessageDigest(a.hashAlgorithm);return r.update(n),"g"!==n&&r.update(a.getRelatedPredicate(s)),r.update(o),r.digest()}hashNDegreeQuads(e,s){const t=this,n=new MessageDigest(t.hashAlgorithm),a=t.createHashToRelated(e,s),o=Object.keys(a).sort();for(let e=0;e<o.length;++e){const r=o[e];n.update(r);let h,l="";const i=new Permutator(a[r]);for(;i.hasNext();){const e=i.next();let n=s.clone(),a="";const o=[];let r=!1;for(let s=0;s<e.length;++s){const h=e[s];if(t.canonicalIssuer.hasId(h)?a+=t.canonicalIssuer.getId(h):(n.hasId(h)||o.push(h),a+=n.getId(h)),0!==l.length&&a.length>=l.length&&a>l){r=!0;break}}if(!r){for(let e=0;e<o.length;++e){const s=o[e],h=t.hashNDegreeQuads(s,n);if(a+=n.getId(s),a+="<"+h.hash+">",n=h.issuer,0!==l.length&&a.length>=l.length&&a>l){r=!0;break}}r||(0===l.length||a<l)&&(l=a,h=n)}}n.update(l),s=h}return{hash:n.digest(),issuer:s}}modifyFirstDegreeComponent(e,s){return"BlankNode"!==s.termType?s:((s=util.clone(s)).value=s.value===e?"_:a":"_:z",s)}getRelatedPredicate(e){return"<"+e.predicate.value+">"}createHashToRelated(e,s){const t=this,n={},a=t.blankNodeInfo[e].quads;for(let o=0;o<a.length;++o){const r=a[o];for(const a in r){const o=r[a];if("predicate"===a||"BlankNode"!==o.termType||o.value===e)continue;const h=o.value,l=POSITIONS[a],i=t.hashRelatedBlankNode(h,r,s,l);i in n?n[i].push(h):n[i]=[h]}}return n}forEachComponent(e,s){for(const t in e)"predicate"!==t&&s(e[t],t,e)}};

},{"./IdentifierIssuer":32,"./MessageDigest":33,"./NQuads":34,"./Permutator":35,"./util":41}],38:[function(require,module,exports){
"use strict";const URDNA2015=require("./URDNA2015"),util=require("./util");module.exports=class extends URDNA2015{constructor(e){super(e),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(e,t,a){return"BlankNode"!==t.termType?t:((t=util.clone(t)).value="name"===a?"_:g":t.value===e?"_:a":"_:z",t)}getRelatedPredicate(e){return e.predicate.value}createHashToRelated(e,t,a){const r=this,u={},l=r.blankNodeInfo[e].quads;r.forEach(l,(a,l,s)=>{let o,n;if("BlankNode"===a.subject.termType&&a.subject.value!==e)n=a.subject.value,o="p";else{if("BlankNode"!==a.object.termType||a.object.value===e)return s();n=a.object.value,o="r"}r.hashRelatedBlankNode(n,a,t,o,(e,t)=>{if(e)return s(e);t in u?u[t].push(n):u[t]=[n],s()})},e=>a(e,u))}};

},{"./URDNA2015":36,"./util":41}],39:[function(require,module,exports){
"use strict";const URDNA2015Sync=require("./URDNA2015Sync"),util=require("./util");module.exports=class extends URDNA2015Sync{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(e,t,a){return"BlankNode"!==t.termType?t:((t=util.clone(t)).value="name"===a?"_:g":t.value===e?"_:a":"_:z",t)}getRelatedPredicate(e){return e.predicate.value}createHashToRelated(e,t){const a=this,n={},l=a.blankNodeInfo[e].quads;for(let r=0;r<l.length;++r){const s=l[r];let o,u;if("BlankNode"===s.subject.termType&&s.subject.value!==e)u=s.subject.value,o="p";else{if("BlankNode"!==s.object.termType||s.object.value===e)continue;u=s.object.value,o="r"}const c=a.hashRelatedBlankNode(u,s,t,o);c in n?n[c].push(u):n[c]=[u]}return n}};

},{"./URDNA2015Sync":37,"./util":41}],40:[function(require,module,exports){
"use strict";const util=require("./util"),URDNA2015=require("./URDNA2015"),URGNA2012=require("./URGNA2012"),URDNA2015Sync=require("./URDNA2015Sync"),URGNA2012Sync=require("./URGNA2012Sync");let rdfCanonizeNative;try{rdfCanonizeNative=require("rdf-canonize-native")}catch(i){}const api={};module.exports=api,api.NQuads=require("./NQuads"),api.IdentifierIssuer=require("./IdentifierIssuer"),api._rdfCanonizeNative=function(i){return i&&(rdfCanonizeNative=i),rdfCanonizeNative},api.canonize=util.callbackify(async function(i,a){let e;const n=new Promise((i,a)=>{e=((e,n)=>{if(e)return a(e);i(n)})});if(Array.isArray(i)||(i=api.NQuads.legacyDatasetToQuads(i)),a.useNative){if(!rdfCanonizeNative)throw new Error("rdf-canonize-native not available");rdfCanonizeNative.canonize(i,a,e)}else if("URDNA2015"===a.algorithm)new URDNA2015(a).main(i,e);else{if("URGNA2012"!==a.algorithm)throw"algorithm"in a?new Error("Invalid RDF Dataset Canonicalization algorithm: "+a.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.");new URGNA2012(a).main(i,e)}return n}),api.canonizeSync=function(i,a){if(Array.isArray(i)||(i=api.NQuads.legacyDatasetToQuads(i)),a.useNative){if(rdfCanonizeNative)return rdfCanonizeNative.canonizeSync(i,a);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===a.algorithm)return new URDNA2015Sync(a).main(i);if("URGNA2012"===a.algorithm)return new URGNA2012Sync(a).main(i);if(!("algorithm"in a))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+a.algorithm)};

},{"./IdentifierIssuer":32,"./NQuads":34,"./URDNA2015":36,"./URDNA2015Sync":37,"./URGNA2012":38,"./URGNA2012Sync":39,"./util":41,"rdf-canonize-native":1}],41:[function(require,module,exports){
(function (process,setImmediate){
"use strict";const api={};module.exports=api;const _setImmediate="function"==typeof setImmediate&&setImmediate,_delay=_setImmediate?e=>_setImmediate(e):e=>setTimeout(e,0);function _invokeCallback(e,t,i){try{return e(t,i)}catch(e){process.nextTick(()=>{throw e})}}"object"==typeof process&&"function"==typeof process.nextTick?api.nextTick=process.nextTick:api.nextTick=_delay,api.setImmediate=_setImmediate?_delay:api.nextTick,api.clone=function(e){if(e&&"object"==typeof e){let t;if(Array.isArray(e)){t=[];for(let i=0;i<e.length;++i)t[i]=api.clone(e[i])}else if(api.isObject(e)){t={};for(const i in e)t[i]=api.clone(e[i])}else t=e.toString();return t}return e},api.isObject=(e=>"[object Object]"===Object.prototype.toString.call(e)),api.isUndefined=(e=>void 0===e),api.callbackify=(e=>(async function(...t){const i=t[t.length-1];let n;"function"==typeof i&&t.pop();try{n=await e.apply(null,t)}catch(e){if("function"==typeof i)return _invokeCallback(i,e);throw e}return"function"==typeof i?_invokeCallback(i,null,n):n}));

}).call(this,require('_process'),require("timers").setImmediate)
},{"_process":30,"timers":42}],42:[function(require,module,exports){
(function (setImmediate,clearImmediate){
var nextTick=require("process/browser.js").nextTick,apply=Function.prototype.apply,slice=Array.prototype.slice,immediateIds={},nextImmediateId=0;function Timeout(e,t){this._id=e,this._clearFn=t}exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)},exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)},exports.clearTimeout=exports.clearInterval=function(e){e.close()},Timeout.prototype.unref=Timeout.prototype.ref=function(){},Timeout.prototype.close=function(){this._clearFn.call(window,this._id)},exports.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},exports.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},exports._unrefActive=exports.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},exports.setImmediate="function"==typeof setImmediate?setImmediate:function(e){var t=nextImmediateId++,i=!(arguments.length<2)&&slice.call(arguments,1);return immediateIds[t]=!0,nextTick(function(){immediateIds[t]&&(i?e.apply(null,i):e.call(null),exports.clearImmediate(t))}),t},exports.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(e){delete immediateIds[e]};

}).call(this,require("timers").setImmediate,require("timers").clearImmediate)
},{"process/browser.js":30,"timers":42}],43:[function(require,module,exports){
"use strict";var _createClass=function(){function e(e,s){for(var t=0;t<s.length;t++){var r=s[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(s,t,r){return t&&e(s.prototype,t),r&&e(s,r),s}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var s=0,t=Array(e.length);s<e.length;s++)t[s]=e[s];return t}return Array.from(e)}function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}var util=require("./utilities"),Class=function(){function e(s,t){_classCallCheck(this,e),this.IRI=s,this.graph=t}return _createClass(e,[{key:"getIRI",value:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.IRI:util.toAbsoluteIRI(this.IRI,this.graph.context)}},{key:"getTermType",value:function(){return"rdfs:Class"}},{key:"getVocabulary",value:function(){var e=this.graph.classes[this.IRI];return void 0!==e["schema:isPartOf"]?e["schema:isPartOf"]:null}},{key:"getSource",value:function(){var e=this.graph.classes[this.IRI];return void 0!==e["dc:source"]?e["dc:source"]:null}},{key:"isSupersededBy",value:function(){var e=this.graph.classes[this.IRI];return util.isString(e["schema:supersededBy"])?e["schema:supersededBy"]:null}},{key:"getName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",s=this.graph.classes[this.IRI]["rdfs:label"];return null===s||void 0===s[e]?null:s[e]}},{key:"getDescription",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",s=this.graph.classes[this.IRI]["rdfs:comment"];return null===s||void 0===s[e]?null:s[e]}},{key:"getProperties",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=this.graph.classes[this.IRI],r=[];return r.push.apply(r,_toConsumableArray(t["soa:hasProperty"])),!0===e&&r.push.apply(r,_toConsumableArray(this.graph.reasoner.inferPropertiesFromSuperClasses(t["rdfs:subClassOf"]))),util.applyFilter(util.uniquifyArray(r),s,this.graph)}},{key:"getSuperClasses",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=this.graph.classes[this.IRI],r=[];return!0===e?r.push.apply(r,_toConsumableArray(this.graph.reasoner.inferImplicitSuperClasses(this.IRI))):r.push.apply(r,_toConsumableArray(t["rdfs:subClassOf"])),util.applyFilter(util.uniquifyArray(r),s,this.graph)}},{key:"getSubClasses",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=this.graph.classes[this.IRI],r=[];return!0===e?r.push.apply(r,_toConsumableArray(this.graph.reasoner.inferImplicitSubClasses(this.IRI))):r.push.apply(r,_toConsumableArray(t["soa:superClassOf"])),util.applyFilter(util.uniquifyArray(r),s,this.graph)}},{key:"toString",value:function(){return JSON.stringify(this.toJSON(!1,null),null,2)}},{key:"toJSON",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t={};return t.id=this.getIRI(!0),t.IRI=this.getIRI(),t.type=this.getTermType(),t.vocabulary=this.getVocabulary(),t.source=this.getSource(),t.supersededBy=this.isSupersededBy(),t.name=this.getName(),t.description=this.getDescription(),t.superClasses=this.getSuperClasses(e,s),t.subClasses=this.getSubClasses(e,s),t.properties=this.getProperties(e,s),t}}]),e}();module.exports=Class;

},{"./utilities":51}],44:[function(require,module,exports){
"use strict";var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var util=require("./utilities"),DataType=function(){function e(t,r){_classCallCheck(this,e),this.IRI=t,this.graph=r}return _createClass(e,[{key:"getIRI",value:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.IRI:util.toAbsoluteIRI(this.IRI,this.graph.context)}},{key:"getTermType",value:function(){return"schema:DataType"}},{key:"getVocabulary",value:function(){var e=this.graph.dataTypes[this.IRI];return void 0!==e["schema:isPartOf"]?e["schema:isPartOf"]:null}},{key:"getSource",value:function(){var e=this.graph.dataTypes[this.IRI];return void 0!==e["dc:source"]?e["dc:source"]:null}},{key:"isSupersededBy",value:function(){var e=this.graph.dataTypes[this.IRI];return util.isString(e["schema:supersededBy"])?e["schema:supersededBy"]:null}},{key:"getName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=this.graph.dataTypes[this.IRI]["rdfs:label"];return null===t||void 0===t[e]?null:t[e]}},{key:"getDescription",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=this.graph.dataTypes[this.IRI]["rdfs:comment"];return null===t||void 0===t[e]?null:t[e]}},{key:"getSuperDataTypes",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.graph.dataTypes[this.IRI],a=[];return!0===e?a.push.apply(a,_toConsumableArray(this.graph.reasoner.inferImplicitSuperDataTypes(this.IRI))):a.push.apply(a,_toConsumableArray(r["rdfs:subClassOf"])),util.applyFilter(util.uniquifyArray(a),t,this.graph)}},{key:"getSubDataTypes",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.graph.dataTypes[this.IRI],a=[];return!0===e?a.push.apply(a,_toConsumableArray(this.graph.reasoner.inferImplicitSubDataTypes(this.IRI))):a.push.apply(a,_toConsumableArray(r["soa:superClassOf"])),util.applyFilter(util.uniquifyArray(a),t,this.graph)}},{key:"toString",value:function(){return JSON.stringify(this.toJSON(!1,null),null,2)}},{key:"toJSON",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r={};return r.id=this.getIRI(!0),r.IRI=this.getIRI(),r.type=this.getTermType(),r.vocabulary=this.getVocabulary(),r.source=this.getSource(),r.supersededBy=this.isSupersededBy(),r.name=this.getName(),r.description=this.getDescription(),r.superDataTypes=this.getSuperDataTypes(e,t),r.subDataTypes=this.getSubDataTypes(e,t),r}}]),e}();module.exports=DataType;

},{"./utilities":51}],45:[function(require,module,exports){
"use strict";var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var util=require("./utilities"),Enumeration=function(){function e(t,r){_classCallCheck(this,e),this.IRI=t,this.graph=r}return _createClass(e,[{key:"getIRI",value:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.IRI:util.toAbsoluteIRI(this.IRI,this.graph.context)}},{key:"getTermType",value:function(){return"schema:Enumeration"}},{key:"getVocabulary",value:function(){var e=this.graph.enumerations[this.IRI];return void 0!==e["schema:isPartOf"]?e["schema:isPartOf"]:null}},{key:"getSource",value:function(){var e=this.graph.enumerations[this.IRI];return void 0!==e["dc:source"]?e["dc:source"]:null}},{key:"isSupersededBy",value:function(){var e=this.graph.enumerations[this.IRI];return util.isString(e["schema:supersededBy"])?e["schema:supersededBy"]:null}},{key:"getName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=this.graph.enumerations[this.IRI]["rdfs:label"];return null===t||void 0===t[e]?null:t[e]}},{key:"getDescription",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=this.graph.enumerations[this.IRI]["rdfs:comment"];return null===t||void 0===t[e]?null:t[e]}},{key:"getEnumerationMembers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.graph.enumerations[this.IRI]["soa:hasEnumerationMember"];return util.applyFilter(util.uniquifyArray(t),e,this.graph)}},{key:"getProperties",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.graph.enumerations[this.IRI],s=[];return s.push.apply(s,_toConsumableArray(r["soa:hasProperty"])),!0===e&&s.push.apply(s,_toConsumableArray(this.graph.reasoner.inferPropertiesFromSuperClasses(r["rdfs:subClassOf"]))),util.applyFilter(util.uniquifyArray(s),t,this.graph)}},{key:"getSuperClasses",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.graph.enumerations[this.IRI],s=[];return!0===e?s.push.apply(s,_toConsumableArray(this.graph.reasoner.inferImplicitSuperClasses(this.IRI))):s.push.apply(s,_toConsumableArray(r["rdfs:subClassOf"])),util.applyFilter(util.uniquifyArray(s),t,this.graph)}},{key:"getSubClasses",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.graph.enumerations[this.IRI],s=[];return!0===e?s.push.apply(s,_toConsumableArray(this.graph.reasoner.inferImplicitSubClasses(this.IRI))):s.push.apply(s,_toConsumableArray(r["soa:superClassOf"])),util.applyFilter(util.uniquifyArray(s),t,this.graph)}},{key:"toString",value:function(){return JSON.stringify(this.toJSON(!1,null),null,2)}},{key:"toJSON",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r={};return r.id=this.getIRI(!0),r.IRI=this.getIRI(),r.type=this.getTermType(),r.vocabulary=this.getVocabulary(),r.source=this.getSource(),r.supersededBy=this.isSupersededBy(),r.name=this.getName(),r.description=this.getDescription(),r.enumerationMembers=this.getEnumerationMembers(t),r.superClasses=this.getSuperClasses(e,t),r.subClasses=this.getSubClasses(e,t),r.properties=this.getProperties(e,t),r}}]),e}();module.exports=Enumeration;

},{"./utilities":51}],46:[function(require,module,exports){
"use strict";var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var util=require("./utilities"),EnumerationMember=function(){function e(t,n){_classCallCheck(this,e),this.IRI=t,this.graph=n}return _createClass(e,[{key:"getIRI",value:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.IRI:util.toAbsoluteIRI(this.IRI,this.graph.context)}},{key:"getTermType",value:function(){return"soa:EnumerationMember"}},{key:"getVocabulary",value:function(){var e=this.graph.enumerationMembers[this.IRI];return void 0!==e["schema:isPartOf"]?e["schema:isPartOf"]:null}},{key:"getSource",value:function(){var e=this.graph.enumerationMembers[this.IRI];return void 0!==e["dc:source"]?e["dc:source"]:null}},{key:"isSupersededBy",value:function(){var e=this.graph.enumerationMembers[this.IRI];return util.isString(e["schema:supersededBy"])?e["schema:supersededBy"]:null}},{key:"getName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=this.graph.enumerationMembers[this.IRI]["rdfs:label"];return null===t||void 0===t[e]?null:t[e]}},{key:"getDescription",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=this.graph.enumerationMembers[this.IRI]["rdfs:comment"];return null===t||void 0===t[e]?null:t[e]}},{key:"getDomainEnumerations",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.graph.enumerationMembers[this.IRI]["soa:enumerationDomainIncludes"];return util.applyFilter(util.uniquifyArray(t),e,this.graph)}},{key:"toString",value:function(){return JSON.stringify(this.toJSON(!1,null),null,2)}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t={};return t.id=this.getIRI(!0),t.IRI=this.getIRI(),t.type=this.getTermType(),t.vocabulary=this.getVocabulary(),t.source=this.getSource(),t.supersededBy=this.isSupersededBy(),t.name=this.getName(),t.description=this.getDescription(),t.domainEnumerations=this.getDomainEnumerations(e),t}}]),e}();module.exports=EnumerationMember;

},{"./utilities":51}],47:[function(require,module,exports){
"use strict";var _createClass=function(){function e(e,s){for(var r=0;r<s.length;r++){var a=s[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(s,r,a){return r&&e(s.prototype,r),a&&e(s,a),s}}();function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}var util=require("./utilities"),Class=require("./Class"),Property=require("./Property"),Enumeration=require("./Enumeration"),EnumerationMember=require("./EnumerationMember"),DataType=require("./DataType"),ReasoningEngine=require("./ReasoningEngine"),Graph=function(){function e(s){_classCallCheck(this,e),this.sdoAdapter=s,this.reasoner=new ReasoningEngine(this),this.context={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",xsd:"http://www.w3.org/2001/XMLSchema#",dc:"http://purl.org/dc/terms/",schema:"http://schema.org/",soa:"http://schema-org-adapter.at/vocabTerms/","soa:superClassOf":{"@id":"soa:superClassOf","@type":"@id"},"soa:superPropertyOf":{"@id":"soa:superPropertyOf","@type":"@id"},"soa:hasProperty":{"@id":"soa:hasProperty","@type":"@id"},"soa:isRangeOf":{"@id":"soa:isRangeOf","@type":"@id"},"soa:hasEnumerationMember":{"@id":"soa:hasEnumerationMember","@type":"@id"},"soa:enumerationDomainIncludes":{"@id":"soa:enumerationDomainIncludes","@type":"@id"},"rdfs:subClassOf":{"@id":"rdfs:subClassOf","@type":"@id"},"rdfs:subPropertyOf":{"@id":"rdfs:subPropertyOf","@type":"@id"},"schema:isPartOf":{"@id":"schema:isPartOf","@type":"@id"},"schema:domainIncludes":{"@id":"schema:domainIncludes","@type":"@id"},"schema:rangeIncludes":{"@id":"schema:rangeIncludes","@type":"@id"},"schema:supersededBy":{"@id":"schema:supersededBy","@type":"@id"},"schema:inverseOf":{"@id":"schema:inverseOf","@type":"@id"},"dc:source":{"@id":"dc:source","@type":"@id"}},this.classes={},this.properties={},this.dataTypes={},this.enumerations={},this.enumerationMembers={}}return _createClass(e,[{key:"addVocabulary",value:async function(e){try{this.context=util.generateContext(this.context,e["@context"]),e=await util.preProcessVocab(e,this.context);for(var s=this.sdoAdapter.getVocabularies(),r=0;r<e["@graph"].length;r++)e["@graph"][r]=util.curateNode(e["@graph"][r],s);for(var a=0;a<e["@graph"].length;a++){var t=JSON.parse(JSON.stringify(e["@graph"][a]));if(util.isString(t["@type"]))switch(t["@type"]){case"rdfs:Class":this.addGraphNode(this.classes,t);break;case"rdf:Property":this.addGraphNode(this.properties,t);break;default:this.addGraphNode(this.enumerationMembers,t)}else util.isArray(t["@type"])?-1!==t["@type"].indexOf("rdfs:Class")&&-1!==t["@type"].indexOf("schema:DataType")?this.addGraphNode(this.dataTypes,t):this.addGraphNode(this.enumerationMembers,t):(console.log("unexpected @type format for the following node:"),console.log(JSON.stringify(t,null,2)))}var i=void 0;do{i=!1;for(var o=Object.keys(this.classes),n=Object.keys(this.enumerations),h=0;h<o.length;h++)if(void 0!==this.classes[o[h]]["rdfs:subClassOf"])for(var l=this.classes[o[h]]["rdfs:subClassOf"],u=0;u<l.length;u++)-1===n.indexOf(l[u])&&"schema:Enumeration"!==l[u]||void 0!==this.classes[o[h]]&&void 0===this.enumerations[o[h]]&&(i=!0,this.enumerations[o[h]]=JSON.parse(JSON.stringify(this.classes[o[h]])),delete this.classes[o[h]])}while(i);var d=void 0;do{d=!1;for(var f=Object.keys(this.classes),c=Object.keys(this.dataTypes),p=0;p<f.length;p++)if(void 0!==this.classes[f[p]]["rdfs:subClassOf"])for(var m=this.classes[f[p]]["rdfs:subClassOf"],y=0;y<m.length;y++)-1===c.indexOf(m[y])&&"schema:DataType"!==m[y]||void 0!==this.classes[f[p]]&&void 0===this.dataTypes[f[p]]&&(d=!0,this.dataTypes[f[p]]=JSON.parse(JSON.stringify(this.classes[f[p]])),delete this.classes[f[p]])}while(d);for(var v=Object.keys(this.dataTypes),O=0;O<v.length;O++)this.dataTypes[v[O]]["@type"]="schema:DataType";for(var g=Object.keys(this.classes),b=0;b<g.length;b++){var w=this.classes[g[b]]["rdfs:subClassOf"];void 0===this.classes[g[b]]["soa:superClassOf"]&&(this.classes[g[b]]["soa:superClassOf"]=[]);for(var I=0;I<w.length;I++){var C=this.classes[w[I]];void 0===C&&(C=this.enumerations[w[I]]),void 0!==C&&(void 0!==C["soa:superClassOf"]?-1===C["soa:superClassOf"].indexOf(g[b])&&C["soa:superClassOf"].push(g[b]):C["soa:superClassOf"]=[g[b]])}}for(var P=Object.keys(this.enumerations),E=0;E<P.length;E++){var k=this.enumerations[P[E]]["rdfs:subClassOf"];void 0===this.enumerations[P[E]]["soa:superClassOf"]&&(this.enumerations[P[E]]["soa:superClassOf"]=[]);for(var T=0;T<k.length;T++){var R=this.classes[k[T]];void 0===R&&(R=this.enumerations[k[T]]),void 0!==R&&(void 0!==R["soa:superClassOf"]?-1===R["soa:superClassOf"].indexOf(P[E])&&R["soa:superClassOf"].push(P[E]):R["soa:superClassOf"]=[P[E]])}}for(var M=Object.keys(this.dataTypes),x=0;x<M.length;x++){var j=this.dataTypes[M[x]]["rdfs:subClassOf"];if(void 0===this.dataTypes[M[x]]["soa:superClassOf"]&&(this.dataTypes[M[x]]["soa:superClassOf"]=[]),void 0===j)this.dataTypes[M[x]]["rdfs:subClassOf"]=[];else for(var D=0;D<j.length;D++){var N=this.dataTypes[j[D]];void 0!==N&&(void 0!==N["soa:superClassOf"]?-1===N["soa:superClassOf"].indexOf(M[x])&&N["soa:superClassOf"].push(M[x]):N["soa:superClassOf"]=[M[x]])}}for(var S=Object.keys(this.properties),A=0;A<S.length;A++){var J=this.properties[S[A]]["rdfs:subPropertyOf"];if(void 0===this.properties[S[A]]["soa:superPropertyOf"]&&(this.properties[S[A]]["soa:superPropertyOf"]=[]),void 0===J)this.properties[S[A]]["rdfs:subPropertyOf"]=[];else for(var G=0;G<J.length;G++){var q=this.properties[J[G]];void 0!==q&&(void 0!==q["soa:superPropertyOf"]?-1===q["soa:superPropertyOf"].indexOf(S[A])&&q["soa:superPropertyOf"].push(S[A]):q["soa:superPropertyOf"]=[S[A]])}}g=Object.keys(this.classes);for(var L=0;L<g.length;L++)void 0===this.classes[g[L]]["soa:hasProperty"]&&(this.classes[g[L]]["soa:hasProperty"]=[]),void 0===this.classes[g[L]]["soa:isRangeOf"]&&(this.classes[g[L]]["soa:isRangeOf"]=[]);P=Object.keys(this.enumerations);for(var B=0;B<P.length;B++)void 0===this.enumerations[P[B]]["soa:hasEnumerationMember"]&&(this.enumerations[P[B]]["soa:hasEnumerationMember"]=[]),void 0===this.enumerations[P[B]]["soa:isRangeOf"]&&(this.enumerations[P[B]]["soa:isRangeOf"]=[]),void 0===this.enumerations[P[B]]["soa:hasProperty"]&&(this.enumerations[P[B]]["soa:hasProperty"]=[]);for(var F=Object.keys(this.enumerationMembers),_=0;_<F.length;_++)void 0===this.enumerationMembers[F[_]]["soa:enumerationDomainIncludes"]&&(this.enumerationMembers[F[_]]["soa:enumerationDomainIncludes"]=[]);S=Object.keys(this.properties);for(var V=0;V<S.length;V++){var U=this.properties[S[V]]["schema:domainIncludes"];if(util.isArray(U))for(var W=0;W<U.length;W++){var X=this.classes[U[W]];void 0===X&&(X=this.enumerations[U[W]]),void 0!==X&&util.isArray(X["soa:hasProperty"])&&-1===X["soa:hasProperty"].indexOf(S[V])&&X["soa:hasProperty"].push(S[V])}var z=this.properties[S[V]]["schema:rangeIncludes"];if(util.isArray(z))for(var H=0;H<z.length;H++){var K=this.classes[z[H]];void 0===K&&(K=this.enumerations[z[H]]),void 0!==K&&util.isArray(K["soa:isRangeOf"])&&-1===K["soa:isRangeOf"].indexOf(S[V])&&K["soa:isRangeOf"].push(S[V])}}F=Object.keys(this.enumerationMembers);for(var Q=0;Q<F.length;Q++){var Y=this.enumerationMembers[F[Q]],Z=Y["@type"];util.isArray(Z)||(Z=[Z]);for(var $=0;$<Z.length;$++){var ee=this.enumerations[Z[$]];void 0!==ee&&util.isArray(ee["soa:hasEnumerationMember"])&&-1===ee["soa:hasEnumerationMember"].indexOf(F[Q])&&(ee["soa:hasEnumerationMember"].push(F[Q]),util.isArray(Y["soa:enumerationDomainIncludes"])?Y["soa:enumerationDomainIncludes"].push(Z[$]):Y["soa:enumerationDomainIncludes"]=[Z[$]])}}return!0}catch(E){return console.log(E),!1}}},{key:"addGraphNode",value:function(e,s){try{if(void 0===e[s["@id"]])e[s["@id"]]=s;else{var r=e[s["@id"]];if(void 0!==s["schema:isPartOf"]&&null!==s["schema:isPartOf"]&&(r["schema:isPartOf"]=s["schema:isPartOf"]),void 0!==s["dc:source"]&&null!==s["dc:source"]&&(r["dc:source"]=s["dc:source"]),void 0!==s["schema:category"]&&null!==s["schema:category"]&&(r["schema:category"]=s["schema:category"]),void 0!==s["schema:supersededBy"]&&null!==s["schema:supersededBy"]&&(r["schema:supersededBy"]=s["schema:supersededBy"]),void 0!==s["rdfs:label"]&&null!==s["rdfs:label"])for(var a=Object.keys(s["rdfs:label"]),t=0;t<a.length;t++)r["rdfs:label"][a[t]]=s["rdfs:label"][a[t]];if(void 0!==s["rdfs:comment"]&&null!==s["rdfs:comment"])for(var i=Object.keys(s["rdfs:comment"]),o=0;o<i.length;o++)r["rdfs:comment"][i[o]]=s["rdfs:comment"][i[o]];if(void 0!==s["rdfs:subClassOf"]&&null!==s["rdfs:subClassOf"])for(var n=0;n<s["rdfs:subClassOf"].length;n++)-1===r["rdfs:subClassOf"].indexOf(s["rdfs:subClassOf"][n])&&r["rdfs:subClassOf"].push(s["rdfs:subClassOf"][n]);if(void 0!==s["soa:superClassOf"]&&null!==s["soa:superClassOf"])for(var h=0;h<s["soa:superClassOf"].length;h++)-1===r["soa:superClassOf"].indexOf(s["soa:superClassOf"][h])&&r["soa:superClassOf"].push(s["soa:superClassOf"][h]);if(void 0!==s["soa:hasProperty"]&&null!==s["soa:hasProperty"])for(var l=0;l<s["soa:hasProperty"].length;l++)-1===r["soa:hasProperty"].indexOf(s["soa:hasProperty"][l])&&r["soa:hasProperty"].push(s["soa:hasProperty"][l]);if(void 0!==s["soa:isRangeOf"]&&null!==s["soa:isRangeOf"])for(var u=0;u<s["soa:isRangeOf"].length;u++)-1===r["soa:isRangeOf"].indexOf(s["soa:isRangeOf"][u])&&r["soa:isRangeOf"].push(s["soa:isRangeOf"][u]);if(void 0!==s["soa:enumerationDomainIncludes"]&&null!==s["soa:enumerationDomainIncludes"])for(var d=0;d<s["soa:enumerationDomainIncludes"].length;d++)-1===r["soa:enumerationDomainIncludes"].indexOf(s["soa:enumerationDomainIncludes"][d])&&r["soa:enumerationDomainIncludes"].push(s["soa:enumerationDomainIncludes"][d]);if(void 0!==s["soa:hasEnumerationMember"]&&null!==s["soa:hasEnumerationMember"])for(var f=0;f<s["soa:hasEnumerationMember"].length;f++)-1===r["soa:hasEnumerationMember"].indexOf(s["soa:hasEnumerationMember"][f])&&r["soa:hasEnumerationMember"].push(s["soa:hasEnumerationMember"][f]);if(void 0!==s["rdfs:subPropertyOf"]&&null!==s["rdfs:subPropertyOf"])for(var c=0;c<s["rdfs:subPropertyOf"].length;c++)-1===r["rdfs:subPropertyOf"].indexOf(s["rdfs:subPropertyOf"][c])&&r["rdfs:subPropertyOf"].push(s["rdfs:subPropertyOf"][c]);if(void 0!==s["schema:domainIncludes"]&&null!==s["schema:domainIncludes"])for(var p=0;p<s["schema:domainIncludes"].length;p++)-1===r["schema:domainIncludes"].indexOf(s["schema:domainIncludes"][p])&&r["schema:domainIncludes"].push(s["schema:domainIncludes"][p]);if(void 0!==s["schema:rangeIncludes"]&&null!==s["schema:rangeIncludes"])for(var m=0;m<s["schema:rangeIncludes"].length;m++)-1===r["schema:rangeIncludes"].indexOf(s["schema:rangeIncludes"][m])&&r["schema:rangeIncludes"].push(s["schema:rangeIncludes"][m]);if(void 0!==s["schema:superPropertyOf"]&&null!==s["schema:superPropertyOf"])for(var y=0;y<s["schema:superPropertyOf"].length;y++)-1===r["schema:superPropertyOf"].indexOf(s["schema:superPropertyOf"][y])&&r["schema:superPropertyOf"].push(s["schema:superPropertyOf"][y])}return!0}catch(r){return console.log(r),console.log("memory[newNode[@id]]:"),console.log(JSON.stringify(e[s["@id"]],null,2)),console.log("newNode:"),console.log(JSON.stringify(s,null,2)),!1}}},{key:"getTerm",value:function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.discoverCompactIRI(e),a=void 0,t=void 0,i=0;do{switch(i){case 0:a=this.classes[r],t="Class";break;case 1:a=this.properties[r],t="Property";break;case 2:a=this.dataTypes[r],t="DataType";break;case 3:a=this.enumerations[r],t="Enumeration";break;case 4:a=this.enumerationMembers[r],t="EnumerationMember"}i++}while(void 0===a&&i<6);if(void 0===a)throw new Error("There is no term with the IRI "+e);if(0===(a=util.applyFilter([a["@id"]],s,this)).length)throw new Error("There is no term with that IRI and filter settings.");switch(t){case"Class":return new Class(r,this);case"Property":return new Property(r,this);case"Enumeration":return new Enumeration(r,this);case"EnumerationMember":return new EnumerationMember(r,this);case"DataType":return new DataType(r,this)}}},{key:"getClass",value:function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.discoverCompactIRI(e);if(null!==r){var a=this.classes[r];if(void 0!==a){if(0===(a=util.applyFilter([r],s,this)).length)throw new Error("There is no class with that IRI and filter settings.");return new Class(r,this)}if(void 0!==(a=this.enumerations[r]))try{return this.getEnumeration(r,s)}catch(e){}}throw new Error("There is no class with the IRI "+e)}},{key:"getProperty",value:function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.discoverCompactIRI(e);if(null!==r){var a=this.properties[r];if(void 0!==a){if(0===(a=util.applyFilter([r],s,this)).length)throw new Error("There is no property with that URI and filter settings.");return new Property(r,this)}}throw new Error("There is no property with that URI.")}},{key:"getDataType",value:function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.discoverCompactIRI(e);if(null!==r){var a=this.dataTypes[r];if(void 0!==a){if(0===(a=util.applyFilter([r],s,this)).length)throw new Error("There is no data-type with that IRI and filter settings.");return new DataType(r,this)}}throw new Error("There is no data-type with the IRI "+e)}},{key:"getEnumeration",value:function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.discoverCompactIRI(e);if(null!==r){var a=this.enumerations[r];if(void 0!==a){if(0===(a=util.applyFilter([r],s,this)).length)throw new Error("There is no enumeration with that IRI and filter settings.");return new Enumeration(r,this)}}throw new Error("There is no enumeration with the IRI "+e)}},{key:"getEnumerationMember",value:function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.discoverCompactIRI(e);if(null!==r){var a=this.enumerationMembers[r];if(void 0!==a){if(0===(a=util.applyFilter([r],s,this)).length)throw new Error("There is no EnumerationMember with that IRI and filter settings.");return new EnumerationMember(r,this)}}throw new Error("There is no EnumerationMember with the IRI "+e)}},{key:"discoverCompactIRI",value:function(e){if(-1!==e.indexOf(":"))for(var s=Object.keys(this.context),r=0;r<s.length;r++){var a=this.context[s[r]];if(util.isString(a)){if(e.startsWith(s[r]))return e;if(e.startsWith(a))return util.toCompactIRI(e,this.context)}}else{for(var t=Object.keys(this.classes),i=0;i<t.length;i++)if(!0===this.containsLabel(this.classes[t[i]],e))return t[i];for(var o=Object.keys(this.properties),n=0;n<o.length;n++)if(!0===this.containsLabel(this.properties[o[n]],e))return o[n];for(var h=Object.keys(this.dataTypes),l=0;l<h.length;l++)if(!0===this.containsLabel(this.dataTypes[h[l]],e))return h[l];for(var u=Object.keys(this.enumerations),d=0;d<u.length;d++)if(!0===this.containsLabel(this.enumerations[u[d]],e))return u[d];for(var f=Object.keys(this.enumerationMembers),c=0;c<f.length;c++)if(!0===this.containsLabel(this.enumerationMembers[f[c]],e))return f[c]}return null}},{key:"containsLabel",value:function(e,s){if(void 0!==e&&util.isObject(e["rdfs:label"]))for(var r=Object.keys(e["rdfs:label"]),a=0;a<r.length;a++)if(e["rdfs:label"][r[a]]===s)return!0;return!1}}]),e}();module.exports=Graph;

},{"./Class":43,"./DataType":44,"./Enumeration":45,"./EnumerationMember":46,"./Property":48,"./ReasoningEngine":49,"./utilities":51}],48:[function(require,module,exports){
"use strict";var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(r,t,i){return t&&e(r.prototype,t),i&&e(r,i),r}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var util=require("./utilities"),Property=function(){function e(r,t){_classCallCheck(this,e),this.IRI=r,this.graph=t}return _createClass(e,[{key:"getIRI",value:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.IRI:util.toAbsoluteIRI(this.IRI,this.graph.context)}},{key:"getTermType",value:function(){return"rdf:Property"}},{key:"getVocabulary",value:function(){var e=this.graph.properties[this.IRI];return void 0!==e["schema:isPartOf"]?e["schema:isPartOf"]:null}},{key:"getSource",value:function(){var e=this.graph.properties[this.IRI];return void 0!==e["dc:source"]?e["dc:source"]:null}},{key:"isSupersededBy",value:function(){var e=this.graph.properties[this.IRI];return util.isString(e["schema:supersededBy"])?e["schema:supersededBy"]:null}},{key:"getName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",r=this.graph.properties[this.IRI]["rdfs:label"];return null===r||void 0===r[e]?null:r[e]}},{key:"getDescription",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",r=this.graph.properties[this.IRI]["rdfs:comment"];return null===r||void 0===r[e]?null:r[e]}},{key:"getRanges",value:function(){var e,r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.graph.properties[this.IRI],s=[];if((e=s).push.apply(e,_toConsumableArray(i["schema:rangeIncludes"])),!0===r){for(var n,u=[],a=0;a<s.length;a++)u.push.apply(u,_toConsumableArray(this.graph.reasoner.inferImplicitSubClasses(s[a])));(n=s).push.apply(n,u),s=s.filter(function(e){return null!==e})}return util.applyFilter(util.uniquifyArray(s),t,this.graph)}},{key:"getDomains",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=this.graph.properties[this.IRI],i=[];if(i.push.apply(i,_toConsumableArray(t["schema:domainIncludes"])),!0===e){for(var s=[],n=0;n<i.length;n++)s.push.apply(s,_toConsumableArray(this.graph.reasoner.inferImplicitSubClasses(i[n])));i.push.apply(i,s)}return util.applyFilter(util.uniquifyArray(i),r,this.graph)}},{key:"getSuperProperties",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=this.graph.properties[this.IRI],i=[];return!0===e?i.push.apply(i,_toConsumableArray(this.graph.reasoner.inferSuperProperties(this.IRI))):i.push.apply(i,_toConsumableArray(t["rdfs:subPropertyOf"])),util.applyFilter(util.uniquifyArray(i),r,this.graph)}},{key:"getSubProperties",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=this.graph.properties[this.IRI],i=[];return!0===e?i.push.apply(i,_toConsumableArray(this.graph.reasoner.inferSubProperties(this.IRI))):i.push.apply(i,_toConsumableArray(t["soa:superPropertyOf"])),util.applyFilter(util.uniquifyArray(i),r,this.graph)}},{key:"toString",value:function(){return JSON.stringify(this.toJSON(!1,null),null,2)}},{key:"toJSON",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t={};return t.id=this.getIRI(!0),t.IRI=this.getIRI(),t.type=this.getTermType(),t.vocabulary=this.getVocabulary(),t.source=this.getSource(),t.supersededBy=this.isSupersededBy(),t.name=this.getName(),t.description=this.getDescription(),t.ranges=this.getRanges(e,r),t.domains=this.getDomains(e,r),t.superProperties=this.getSuperProperties(e,r),t.subProperties=this.getSubProperties(e,r),t}}]),e}();module.exports=Property;

},{"./utilities":51}],49:[function(require,module,exports){
"use strict";var _createClass=function(){function r(r,a){for(var s=0;s<a.length;s++){var e=a[s];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}return function(a,s,e){return s&&r(a.prototype,s),e&&r(a,e),a}}();function _toConsumableArray(r){if(Array.isArray(r)){for(var a=0,s=Array(r.length);a<r.length;a++)s[a]=r[a];return s}return Array.from(r)}function _classCallCheck(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")}var util=require("./utilities"),ReasoningEngine=function(){function r(a){_classCallCheck(this,r),this.graph=a}return _createClass(r,[{key:"inferPropertiesFromSuperClasses",value:function(r){for(var a=[],s=0;s<r.length;s++){var e=this.graph.classes[r[s]];void 0===e&&(e=this.graph.enumerations[r[s]]),void 0!==e&&(a.push.apply(a,_toConsumableArray(e["soa:hasProperty"])),0!==e["rdfs:subClassOf"].length&&a.push.apply(a,_toConsumableArray(this.inferPropertiesFromSuperClasses(e["rdfs:subClassOf"]))))}return util.uniquifyArray(a)}},{key:"inferImplicitSuperClasses",value:function(r){var a=this.graph.classes[r],s=[];if(void 0===a&&(a=this.graph.enumerations[r]),void 0!==a){var e;(e=s).push.apply(e,_toConsumableArray(a["rdfs:subClassOf"]));var i=util.copByVal(s);do{for(var u,t=[],l=0;l<i.length;l++){var o,p=this.graph.classes[i[l]];if(void 0===p&&(p=this.graph.enumerations[i[l]]),void 0!==p)(o=t).push.apply(o,_toConsumableArray(p["rdfs:subClassOf"]))}t=util.uniquifyArray(t),i=util.copByVal(t),(u=s).push.apply(u,_toConsumableArray(t))}while(0!==i.length);s=util.uniquifyArray(s)}return s}},{key:"inferImplicitSubClasses",value:function(r){var a=this.graph.classes[r],s=[];if(void 0===a&&(a=this.graph.enumerations[r]),void 0!==a){var e;(e=s).push.apply(e,_toConsumableArray(a["soa:superClassOf"]));var i=util.copByVal(s);do{for(var u,t=[],l=0;l<i.length;l++){var o,p=this.graph.classes[i[l]];if(void 0===p&&(p=this.graph.enumerations[i[l]]),void 0!==p)(o=t).push.apply(o,_toConsumableArray(p["soa:superClassOf"]))}t=util.uniquifyArray(t),i=util.copByVal(t),(u=s).push.apply(u,_toConsumableArray(t))}while(0!==i.length);return s=util.uniquifyArray(s)}return s}},{key:"inferImplicitSuperDataTypes",value:function(r){var a=this.graph.dataTypes[r],s=[];if(void 0!==a){var e;(e=s).push.apply(e,_toConsumableArray(a["rdfs:subClassOf"]));var i=util.copByVal(s);do{for(var u,t=[],l=0;l<i.length;l++){var o,p=this.graph.dataTypes[i[l]];if(void 0!==p)(o=t).push.apply(o,_toConsumableArray(p["rdfs:subClassOf"]))}t=util.uniquifyArray(t),i=util.copByVal(t),(u=s).push.apply(u,_toConsumableArray(t))}while(0!==i.length);s=util.uniquifyArray(s)}return s}},{key:"inferImplicitSubDataTypes",value:function(r){var a=this.graph.dataTypes[r],s=[];if(void 0!==a){var e;(e=s).push.apply(e,_toConsumableArray(a["soa:superClassOf"]));var i=util.copByVal(s);do{for(var u,t=[],l=0;l<i.length;l++){var o,p=this.graph.dataTypes[i[l]];if(void 0!==p)(o=t).push.apply(o,_toConsumableArray(p["soa:superClassOf"]))}t=util.uniquifyArray(t),i=util.copByVal(t),(u=s).push.apply(u,_toConsumableArray(t))}while(0!==i.length);s=util.uniquifyArray(s)}return s}},{key:"inferSubProperties",value:function(r){var a=this.graph.properties[r],s=[];if(void 0!==a){var e;(e=s).push.apply(e,_toConsumableArray(a["soa:superPropertyOf"]));var i=util.copByVal(s);do{for(var u,t=[],l=0;l<i.length;l++){var o,p=this.graph.properties[i[l]];if(void 0!==p)(o=t).push.apply(o,_toConsumableArray(p["soa:superPropertyOf"]))}t=util.uniquifyArray(t),i=util.copByVal(t),(u=s).push.apply(u,_toConsumableArray(t))}while(0!==i.length);s=util.uniquifyArray(s)}return s}},{key:"inferSuperProperties",value:function(r){var a=this.graph.properties[r],s=[];if(void 0!==a){var e;(e=s).push.apply(e,_toConsumableArray(a["rdfs:subPropertyOf"]));var i=util.copByVal(s);do{for(var u,t=[],l=0;l<i.length;l++){var o,p=this.graph.properties[i[l]];if(void 0!==p)(o=t).push.apply(o,_toConsumableArray(p["rdfs:subPropertyOf"]))}t=util.uniquifyArray(t),i=util.copByVal(t),(u=s).push.apply(u,_toConsumableArray(t))}while(0!==i.length);s=util.uniquifyArray(s)}return s}}]),r}();module.exports=ReasoningEngine;

},{"./utilities":51}],50:[function(require,module,exports){
"use strict";var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Graph=require("./../Graph"),util=require("./../utilities"),SDOAdapter=function(){function t(){_classCallCheck(this,t),this.graph=new Graph(this)}return _createClass(t,[{key:"addVocabularies",value:async function(t,e){if(!util.isArray(t))throw new Error("The first argument of the function must be an Array of vocabularies (JSON-LD)");for(var r=0;r<t.length;r++)if(util.isString(t[r]))if(t[r].startsWith("www")||t[r].startsWith("http")){var a=await this.fetchVocabularyFromURL(t[r]);try{await this.graph.addVocabulary(a)}catch(e){console.log("The given URL "+t[r]+" did not contain a valid JSON-LD vocabulary.")}}else try{await this.graph.addVocabulary(JSON.parse(t[r]))}catch(t){console.log("Parsing of vocabulary string produced an invalid JSON-LD.")}else{if(!util.isObject(t[r]))throw new Error("The first argument of the function must be an Array of vocabularies (JSON-LD as Object/String)");await this.graph.addVocabulary(t[r])}null!==e&&e()}},{key:"fetchVocabularyFromURL",value:async function(t){try{return new Promise(function(e,r){var a=new XMLHttpRequest;a.onload=function(){if(200===a.status){var t=JSON.parse(a.response);e(t)}else console.log("Error fetching Vocabulary: "+a.status),r("")},a.open("GET",t,!0),a.send()})}catch(t){return console.log(t),""}}},{key:"getClass",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.graph.getClass(t,e)}},{key:"getAllClasses",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getListOfClasses(t),r=[],a=0;a<e.length;a++)try{r.push(this.getClass(e[a]))}catch(t){}return r}},{key:"getListOfClasses",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return util.applyFilter(Object.keys(this.graph.classes),t,this.graph)}},{key:"getProperty",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.graph.getProperty(t,e)}},{key:"getAllProperties",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getListOfProperties(t),r=[],a=0;a<e.length;a++)try{r.push(this.getProperty(e[a]))}catch(t){}return r}},{key:"getListOfProperties",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return util.applyFilter(Object.keys(this.graph.properties),t,this.graph)}},{key:"getDataType",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.graph.getDataType(t,e)}},{key:"getAllDataTypes",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getListOfDataTypes(t),r=[],a=0;a<e.length;a++)try{r.push(this.getDataType(e[a]))}catch(t){}return r}},{key:"getListOfDataTypes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return util.applyFilter(Object.keys(this.graph.dataTypes),t,this.graph)}},{key:"getEnumeration",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.graph.getEnumeration(t,e)}},{key:"getAllEnumerations",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getListOfEnumerations(t),r=[],a=0;a<e.length;a++)try{r.push(this.getEnumeration(e[a]))}catch(t){}return r}},{key:"getListOfEnumerations",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return util.applyFilter(Object.keys(this.graph.enumerations),t,this.graph)}},{key:"getEnumerationMember",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.graph.getEnumerationMember(t,e)}},{key:"getAllEnumerationMembers",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.getListOfEnumerationMembers(t),r=[],a=0;a<e.length;a++)try{r.push(this.getEnumerationMember(e[a]))}catch(t){}return r}},{key:"getListOfEnumerationMembers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return util.applyFilter(Object.keys(this.graph.enumerationMembers),t,this.graph)}},{key:"getVocabularies",value:function(){for(var t=Object.keys(this.graph.context),e={},r=["soa","xsd","rdf","rdfa","rdfs","dc"],a=0;a<t.length;a++)util.isString(this.graph.context[t[a]])&&-1===r.indexOf(t[a])&&(e[t[a]]=this.graph.context[t[a]]);return e}}]),t}();module.exports=SDOAdapter;

},{"./../Graph":47,"./../utilities":51}],51:[function(require,module,exports){
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r};function _toConsumableArray(r){if(Array.isArray(r)){for(var e=0,s=Array(r.length);e<r.length;e++)s[e]=r[e];return s}return Array.from(r)}var jsonld=require("jsonld");function applyFilter(r,e,s){if(!Array.isArray(r)||0===r.length||null===e||0===Object.keys(e).length)return r;for(var t=[],a=0;a<r.length;a++){var n=s.getTerm(r[a]);if(void 0!==e.isSuperseded){if(!1===e.isSuperseded&&null!==n.isSupersededBy())continue;if(!0===e.isSuperseded&&null===n.isSupersededBy())continue}if(void 0!==e.fromVocabulary){var i=!1;if(isString(e.fromVocabulary))n.getIRI(!0).startsWith(e.fromVocabulary)&&(i=!0);else if(isArray(e.fromVocabulary))for(var o=0;o<e.fromVocabulary.length;o++)n.getIRI(!0).startsWith(e.fromVocabulary[o])&&(i=!0);if(!i)continue}if(void 0!==e.termType){var f=!1,l=[];isString(e.termType)?l.push(e.termType):isArray(e.termType)&&(l=e.termType);for(var c=0;c<l.length;c++){var u=void 0;switch(l[c]){case"Class":u="rdfs:Class";break;case"Property":u="rdf:Property";break;case"Enumeration":u="schema:Enumeration";break;case"EnumerationMember":u="soa:EnumerationMember";break;case"DataType":u="schema:DataType";break;default:console.log("Invalid filter.termType "+l[c])}if(u===n.getTermType()){f=!0;break}}if(!f)continue}t.push(r[a])}return t}function copByVal(r){if(void 0!==r)return JSON.parse(JSON.stringify(r))}function isObject(r){return!Array.isArray(r)&&(null!=r&&"object"===(void 0===r?"undefined":_typeof(r)))}function isString(r){return null!=r&&("string"==typeof r||r instanceof String)}function isArray(r){return Array.isArray(r)}function uniquifyArray(r){for(var e={},s=[],t=0;t<r.length;t++){var a=r[t];1!==e[a]&&(e[a]=1,s.push(a))}return s}function generateContext(r,e){for(var s=Object.keys(r),t=Object.keys(e),a=JSON.parse(JSON.stringify(r)),n=0;n<t.length;n++){var i=t[n];if(isString(e[i])){for(var o=!1,f=0;f<s.length;f++)if(isString(a[s[f]])&&a[s[f]]===e[i]){o=!0;break}if(o)continue;if(void 0===a[i])a[i]=e[i];else if(a[i]!==e[i])for(var l=!1,c=1;!1===l;){var u=i+c++;void 0===a[u]&&(l=!0,a[u]=e[i])}}}var d={};Object.keys(a).sort().forEach(function(r){d[r]=a[r]}),a=d;for(var y=Object.keys(a),m={},p=0;p<y.length;p++)isString(a[y[p]])&&(m[y[p]]=a[y[p]]);for(var b=0;b<y.length;b++)isObject(a[y[b]])&&(m[y[b]]=a[y[b]]);return m}async function preProcessVocab(r,e){var s=!1;do{var t=[];s=!1;for(var a=0;a<r["@graph"].length;a++)void 0!==r["@graph"][a]["@graph"]?(t.push.apply(t,_toConsumableArray(copByVal(r["@graph"][a]["@graph"]))),s=!0):t.push(copByVal(r["@graph"][a]));r["@graph"]=copByVal(t)}while(!0===s);return await jsonld.compact(await jsonld.expand(r),e)}function curateNode(r,e){if(void 0!==r["rdfs:comment"]){if(isString(r["rdfs:comment"]))r["rdfs:comment"]={en:r["rdfs:comment"]};else if(isObject(r["rdfs:comment"])){var s={};s[r["rdfs:comment"]["@language"]]=r["rdfs:comment"]["@value"],r["rdfs:comment"]=copByVal(s)}else if(isArray(r["rdfs:comment"])){for(var t={},a=0;a<r["rdfs:comment"].length;a++)isObject(r["rdfs:comment"][a])&&(t[r["rdfs:comment"][a]["@language"]]=r["rdfs:comment"][a]["@value"]);r["rdfs:comment"]=copByVal(t)}}else r["rdfs:comment"]={};if(void 0!==r["rdfs:label"]){if(isString(r["rdfs:label"]))r["rdfs:label"]={en:r["rdfs:label"]};else if(isObject(r["rdfs:label"])){var n={};n[r["rdfs:label"]["@language"]]=r["rdfs:label"]["@value"],r["rdfs:label"]=copByVal(n)}else if(isArray(r["rdfs:label"])){for(var i={},o=0;o<r["rdfs:label"].length;o++)isObject(r["rdfs:label"][o])&&(i[r["rdfs:label"][o]["@language"]]=r["rdfs:label"][o]["@value"]);r["rdfs:label"]=copByVal(i)}}else r["rdfs:label"]={};if(isString(r["rdfs:subClassOf"])?r["rdfs:subClassOf"]=[r["rdfs:subClassOf"]]:void 0===r["rdfs:subClassOf"]&&"rdfs:Class"===r["@type"]&&(r["rdfs:subClassOf"]=[]),isString(r["rdfs:subPropertyOf"])?r["rdfs:subPropertyOf"]=[r["rdfs:subPropertyOf"]]:void 0===r["rdfs:subPropertyOf"]&&"rdf:Property"===r["@type"]&&(r["rdfs:subPropertyOf"]=[]),isString(r["schema:domainIncludes"])?r["schema:domainIncludes"]=[r["schema:domainIncludes"]]:void 0===r["schema:domainIncludes"]&&"rdf:Property"===r["@type"]&&(r["schema:domainIncludes"]=[]),isString(r["schema:rangeIncludes"])?r["schema:rangeIncludes"]=[r["schema:rangeIncludes"]]:void 0===r["schema:rangeIncludes"]&&"rdf:Property"===r["@type"]&&(r["schema:rangeIncludes"]=[]),!isString(r["schema:isPartOf"])){for(var f=Object.keys(e),l=void 0,c=0;c<f.length;c++)if(r["@id"].substring(0,r["@id"].indexOf(":"))===f[c]){l=e[f[c]];break}if(void 0!==l){var u=void 0;do{u=!1,(l.endsWith("/")||l.endsWith("#"))&&(l=l.substring(0,l.length-1),u=!0)}while(!0===u);r["schema:isPartOf"]=l}}return r}function toCompactIRI(r,e){for(var s=Object.keys(e),t=0;t<s.length;t++){var a=e[s[t]];if(isString(a)&&r.startsWith(a))return s[t]+":"+r.substring(a.length)}return null}function toAbsoluteIRI(r,e){for(var s=Object.keys(e),t=0;t<s.length;t++){var a=e[s[t]];if(r.substring(0,r.indexOf(":"))===s[t])return a.concat(r.substring(r.indexOf(":")+1))}return null}module.exports={applyFilter:applyFilter,copByVal:copByVal,isArray:isArray,isString:isString,isObject:isObject,uniquifyArray:uniquifyArray,preProcessVocab:preProcessVocab,generateContext:generateContext,curateNode:curateNode,toCompactIRI:toCompactIRI,toAbsoluteIRI:toAbsoluteIRI};

},{"jsonld":18}]},{},[50])(50)
});
